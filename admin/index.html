<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ® Warp Zone Gems - æœ¬åœ°ç®¡ç†åå°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* é©¬é‡Œå¥¥ä¸»é¢˜æ ·å¼ */
        .mario-button {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            box-shadow: 0 4px 15px rgba(238, 90, 90, 0.4);
            border: 3px solid #fff;
            transition: all 0.3s ease;
        }
        .mario-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(238, 90, 90, 0.6);
        }
        .blue-button {
            background: linear-gradient(135deg, #4299e1, #2b77cb);
            box-shadow: 0 4px 15px rgba(66, 153, 225, 0.4);
            border: 3px solid #fff;
        }
        .green-button {
            background: linear-gradient(135deg, #48bb78, #38a169);
            box-shadow: 0 4px 15px rgba(72, 187, 120, 0.4);
            border: 3px solid #fff;
        }
        .tab-active {
            background: linear-gradient(135deg, #4299e1, #2b77cb);
            color: white;
            border-bottom: 3px solid #2b77cb;
        }
        .coin-shine {
            animation: shine 2s infinite;
        }
        @keyframes shine {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .floating {
            animation: float 3s ease-in-out infinite;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .status-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        .form-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        .form-input:focus {
            border-color: #4299e1;
            outline: none;
        }
        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }
        .view-tab-btn {
            transition: all 0.3s ease;
        }
        .view-tab-btn.active {
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-weight: bold;
        }
        .game-item {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            background: white;
            transition: all 0.3s ease;
        }
        .game-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .game-item.draft {
            border-left: 4px solid #f59e0b;
        }
        .game-item.published {
            border-left: 4px solid #10b981;
        }
        .status-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-draft {
            background-color: #fef3c7;
            color: #92400e;
        }
        .status-published {
            background-color: #d1fae5;
            color: #065f46;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: white;
            padding: 24px;
            border-radius: 12px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }
        .category-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            justify-content: between;
            align-items: center;
            transition: all 0.3s ease;
        }
        .category-header:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        .category-content {
            display: none;
            padding: 16px;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 8px 8px;
            background: #fafafa;
        }
        .category-content.open {
            display: block;
        }
        .yellow-button {
            background: linear-gradient(135deg, #f59e0b, #d97706);
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
            border: 3px solid #fff;
        }
        .download-link-item {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            background: #f9fafb;
            position: relative;
        }
        .download-link-item.active {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        .remove-link-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #ef4444;
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            line-height: 1;
        }
        .remove-link-btn:hover {
            background: #dc2626;
        }
        .service-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 8px;
            margin-bottom: 12px;
        }
        .service-option {
            padding: 8px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
            font-size: 12px;
        }
        .service-option:hover {
            border-color: #3b82f6;
        }
        .service-option.selected {
            border-color: #3b82f6;
            background: #eff6ff;
            color: #1d4ed8;
            font-weight: bold;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-purple-100 min-h-screen">
    <!-- å¤´éƒ¨å¯¼èˆª -->
    <header class="bg-white shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="text-3xl">ğŸ®</div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">Warp Zone Gems</h1>
                        <p class="text-sm text-gray-600">æœ¬åœ°ç®¡ç†åå°</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div id="apiKeyStatus" class="text-sm">
                        <span class="w-2 h-2 rounded-full bg-yellow-500 inline-block mr-2"></span>
                        <span>æ£€æŸ¥APIé…ç½®...</span>
                    </div>
                    <div id="deploymentStatus" class="text-sm hidden">
                        <span id="deploymentIndicator" class="w-2 h-2 rounded-full bg-gray-500 inline-block mr-2"></span>
                        <span id="deploymentText">å‡†å¤‡å‘å¸ƒ</span>
                    </div>
                    <button onclick="publishToWebsite()" class="green-button text-white px-4 py-2 rounded-lg font-bold">
                        ğŸš€ å‘å¸ƒåˆ°ç½‘ç«™
                    </button>
                    <button onclick="refreshData()" class="mario-button text-white px-4 py-2 rounded-lg font-bold">
                        ğŸ”„ åˆ·æ–°
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="container mx-auto px-4 py-8">
        <!-- ç³»ç»ŸçŠ¶æ€å¡ç‰‡ -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="status-card floating">
                <div class="text-center">
                    <div class="text-3xl coin-shine">ğŸ®</div>
                    <div class="text-2xl font-bold" id="gamesCount">-</div>
                    <div class="text-sm opacity-90">æ¸¸æˆæ€»æ•°</div>
                </div>
            </div>
            <div class="status-card floating" style="animation-delay: 0.5s">
                <div class="text-center">
                    <div class="text-3xl coin-shine">ğŸ“Š</div>
                    <div class="text-2xl font-bold" id="totalViews">-</div>
                    <div class="text-sm opacity-90">æ€»æµè§ˆé‡</div>
                </div>
            </div>
            <div class="status-card floating" style="animation-delay: 1s">
                <div class="text-center">
                    <div class="text-3xl coin-shine">â¬‡ï¸</div>
                    <div class="text-2xl font-bold" id="totalDownloads">-</div>
                    <div class="text-sm opacity-90">æ€»ä¸‹è½½é‡</div>
                </div>
            </div>
            <div class="status-card floating" style="animation-delay: 1.5s">
                <div class="text-center">
                    <div class="text-3xl coin-shine">ğŸ“</div>
                    <div class="text-2xl font-bold" id="categoriesCount">-</div>
                    <div class="text-sm opacity-90">åˆ†ç±»æ•°é‡</div>
                </div>
            </div>
        </div>

        <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
        <div class="bg-white rounded-t-lg shadow-lg">
            <div class="flex border-b overflow-x-auto">
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap tab-active" data-tab="dashboard">
                    ğŸ“Š ä»ªè¡¨æ¿
                </button>
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap" data-tab="games">
                    ğŸ® æ¸¸æˆç®¡ç†
                </button>
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap" data-tab="ai">
                    ğŸ¤– AIæ‰¹é‡å¯¼å…¥
                </button>
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap" data-tab="banners">
                    ğŸ–¼ï¸ Bannerç®¡ç†
                </button>
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap" data-tab="content">
                    ğŸ“ ç½‘ç«™å†…å®¹
                </button>
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap" data-tab="popups">
                    ğŸ”” å¼¹çª—é…ç½®
                </button>
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap" data-tab="floating">
                    ğŸ“± æ‚¬æµ®å…ƒç´ 
                </button>
                <button class="tab-button px-6 py-4 font-bold whitespace-nowrap" data-tab="settings">
                    âš™ï¸ ç½‘ç«™è®¾ç½®
                </button>
            </div>
        </div>

        <!-- æ ‡ç­¾é¡µå†…å®¹ -->
        <div class="bg-white rounded-b-lg shadow-lg p-6">
            <!-- ä»ªè¡¨æ¿ -->
            <div id="dashboard-tab" class="tab-content">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <span class="text-2xl mr-2">ğŸ“ˆ</span>
                            ç³»ç»Ÿä¿¡æ¯
                        </h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>Node.jsç‰ˆæœ¬</span>
                                <span id="nodeVersion" class="text-blue-600 font-mono">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>GitçŠ¶æ€</span>
                                <span id="gitStatus" class="text-green-600">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span>APIé…ç½®</span>
                                <span id="apiConfigStatus" class="text-blue-600">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <span class="text-2xl mr-2">ğŸ”§</span>
                            å¿«é€Ÿæ“ä½œ
                        </h3>
                        <div class="space-y-3">
                            <button onclick="testApiConnection()" class="w-full blue-button text-white px-4 py-3 rounded-lg font-bold">
                                ğŸ§ª æµ‹è¯•AIè¿æ¥
                            </button>
                            <button onclick="switchTab('ai')" class="w-full green-button text-white px-4 py-3 rounded-lg font-bold">
                                ğŸ¤– AIæ‰¹é‡å¯¼å…¥
                            </button>
                            <button onclick="backupData()" class="w-full mario-button text-white px-4 py-3 rounded-lg font-bold">
                                ğŸ’¾ å¤‡ä»½æ•°æ®
                            </button>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="text-lg font-bold mb-4 flex items-center">
                            <span class="text-2xl mr-2">ğŸš€</span>
                            ç½‘ç«™å‘å¸ƒ
                        </h3>
                        <div class="space-y-3">
                            <div class="flex justify-between text-sm">
                                <span>å‘å¸ƒçŠ¶æ€</span>
                                <span id="publishStatus" class="text-green-600 font-bold">å‡†å¤‡å°±ç»ª</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>æœ€åå‘å¸ƒ</span>
                                <span id="lastPublish" class="text-gray-600">-</span>
                            </div>
                            <div class="flex justify-between text-sm">
                                <span>ç½‘ç«™åœ°å€</span>
                                <a href="https://velist.github.io/warp-zone-gems/" target="_blank" class="text-blue-600 hover:underline">æŸ¥çœ‹ç½‘ç«™</a>
                            </div>
                            <button onclick="publishToWebsite()" id="publishButton" class="w-full green-button text-white px-4 py-3 rounded-lg font-bold">
                                ğŸš€ å‘å¸ƒåˆ°GitHub Pages
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æ¸¸æˆç®¡ç† -->
            <div id="games-tab" class="tab-content hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">ğŸ® æ¸¸æˆç®¡ç†</h2>
                    <div class="flex space-x-2">
                        <button onclick="showModal('gameModal')" class="blue-button text-white px-4 py-2 rounded-lg font-bold">
                            â• æ·»åŠ æ¸¸æˆ
                        </button>
                        <button onclick="showTab('drafts')" class="yellow-button text-white px-4 py-2 rounded-lg font-bold" id="draftsBtn">
                            ğŸ“ è‰ç¨¿ç®± (<span id="draftsCount">0</span>)
                        </button>
                        <button onclick="loadGamesData()" class="mario-button text-white px-4 py-2 rounded-lg font-bold">
                            ğŸ”„ åˆ·æ–°åˆ—è¡¨
                        </button>
                    </div>
                </div>

                <!-- æ¸¸æˆè§†å›¾åˆ‡æ¢æ ‡ç­¾ -->
                <div class="bg-gray-100 rounded-lg p-1 mb-6 inline-flex">
                    <button class="view-tab-btn px-4 py-2 rounded-md active" data-view="published" onclick="switchGameView('published')">
                        ğŸ“¢ å·²å‘å¸ƒ
                    </button>
                    <button class="view-tab-btn px-4 py-2 rounded-md" data-view="drafts" onclick="switchGameView('drafts')">
                        ğŸ“ è‰ç¨¿ç®±
                    </button>
                    <button class="view-tab-btn px-4 py-2 rounded-md" data-view="categories" onclick="switchGameView('categories')">
                        ğŸ“ åˆ†ç±»è§†å›¾
                    </button>
                </div>

                <!-- å·²å‘å¸ƒæ¸¸æˆè§†å›¾ -->
                <div id="publishedGamesView" class="game-view">
                    <div id="publishedGamesGrid" class="space-y-4">
                        <!-- å·²å‘å¸ƒæ¸¸æˆåˆ—è¡¨ -->
                    </div>
                </div>

                <!-- è‰ç¨¿ç®±è§†å›¾ -->
                <div id="draftsView" class="game-view hidden">
                    <div id="draftsGrid" class="space-y-4">
                        <!-- è‰ç¨¿æ¸¸æˆåˆ—è¡¨ -->
                    </div>
                </div>

                <!-- åˆ†ç±»è§†å›¾ -->
                <div id="categoriesView" class="game-view hidden">
                    <div id="categoriesAccordion" class="space-y-2">
                        <!-- åˆ†ç±»æ‰‹é£ç´ -->
                    </div>
                </div>
            </div>

            <!-- AIæ‰¹é‡å¯¼å…¥ -->
            <div id="ai-tab" class="tab-content hidden">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-bold mb-6 text-center">ğŸ¤– AIæ‰¹é‡å¯¼å…¥æ¸¸æˆä¿¡æ¯</h2>
                    
                    <div class="bg-green-50 border-l-4 border-green-400 p-4 mb-6" id="apiKeyNotice">
                        <div class="flex">
                            <div class="text-2xl mr-3">âœ…</div>
                            <div>
                                <p class="font-bold text-green-800">API Keyå·²é…ç½®</p>
                                <p class="text-green-700">ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„Silicon Flow API Keyï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥</p>
                            </div>
                        </div>
                    </div>

                    <!-- APIé…ç½® -->
                    <div class="bg-gray-50 p-6 rounded-lg mb-6">
                        <h3 class="text-lg font-bold mb-4">ğŸ”‘ AIæ¨¡å‹é…ç½®</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">Silicon Flow API Key (å¯é€‰)</label>
                                <input type="password" id="apiKey" class="form-input" placeholder="ç•™ç©ºä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„API Key">
                            </div>
                            <div class="form-group">
                                <label class="form-label">AIæ¨¡å‹</label>
                                <select id="aiModel" class="form-input">
                                    <option value="Qwen/Qwen2.5-7B-Instruct">Qwen/Qwen2.5-7B-Instruct</option>
                                    <option value="THUDM/glm-4-9b-chat">THUDM/glm-4-9b-chat</option>
                                    <option value="meta-llama/Meta-Llama-3.1-8B-Instruct">Meta-Llama-3.1-8B-Instruct</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="testApiKey()" class="mario-button text-white px-4 py-2 rounded-lg font-bold mt-4">
                            ğŸ§ª æµ‹è¯•APIé…ç½®
                        </button>
                    </div>

                    <!-- æ‰¹é‡è¾“å…¥ -->
                    <div class="bg-gray-50 p-6 rounded-lg mb-6">
                        <h3 class="text-lg font-bold mb-4">ğŸ“ æ¸¸æˆä¿¡æ¯è¾“å…¥</h3>
                        <div class="form-group">
                            <label class="form-label">æ¸¸æˆåˆ—è¡¨ï¼ˆæ¯è¡Œä¸€ä¸ªæ¸¸æˆï¼‰</label>
                            <textarea id="inputText" class="form-input form-textarea" rows="10" 
                                placeholder="ç¤ºä¾‹ï¼š&#10;Super Mario Bros.&#10;Mario Kart 8&#10;Super Mario Odyssey&#10;Mario Party Superstars"></textarea>
                        </div>
                        <div class="flex space-x-4">
                            <button onclick="startAIProcessing()" class="green-button text-white px-6 py-3 rounded-lg font-bold">
                                ğŸš€ å¼€å§‹AIå¤„ç†
                            </button>
                            <button onclick="clearInput()" class="mario-button text-white px-4 py-3 rounded-lg font-bold">
                                ğŸ—‘ï¸ æ¸…ç©ºè¾“å…¥
                            </button>
                        </div>
                    </div>

                    <!-- å¤„ç†è¿›åº¦ -->
                    <div id="progressSection" class="bg-gray-50 p-6 rounded-lg mb-6 hidden">
                        <h3 class="text-lg font-bold mb-4">â³ å¤„ç†è¿›åº¦</h3>
                        <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                            <div id="progressBar" class="bg-blue-600 h-4 rounded-full" style="width: 0%"></div>
                        </div>
                        <div id="progressText" class="text-center text-gray-600">å‡†å¤‡å¼€å§‹...</div>
                    </div>

                    <!-- å¤„ç†ç»“æœ -->
                    <div id="resultSection" class="bg-gray-50 p-6 rounded-lg hidden">
                        <h3 class="text-lg font-bold mb-4">ğŸ“Š å¤„ç†ç»“æœ</h3>
                        <div id="resultContent"></div>
                    </div>
                </div>
            </div>

            <!-- Bannerç®¡ç† -->
            <div id="banners-tab" class="tab-content hidden">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">ğŸ–¼ï¸ Bannerç®¡ç†</h2>
                    <button onclick="loadBannersData()" class="mario-button text-white px-4 py-2 rounded-lg font-bold">
                        ğŸ”„ åˆ·æ–°åˆ—è¡¨
                    </button>
                </div>
                <div id="bannersGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Bannerå¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- ç½‘ç«™å†…å®¹ç®¡ç† -->
            <div id="content-tab" class="tab-content hidden">
                <div class="max-w-6xl mx-auto">
                    <h2 class="text-2xl font-bold mb-6">ğŸ“ ç½‘ç«™å†…å®¹ç®¡ç†</h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- å…³äºæˆ‘ä»¬ -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <span class="text-2xl mr-2">â„¹ï¸</span>
                                å…³äºæˆ‘ä»¬
                            </h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">é¡µé¢æ ‡é¢˜</label>
                                    <input type="text" id="aboutTitle" class="form-input" value="å…³äºæˆ‘ä»¬">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">å†…å®¹ (æ”¯æŒHTML)</label>
                                    <textarea id="aboutContent" class="form-input form-textarea" rows="8" placeholder="åœ¨è¿™é‡Œè¾“å…¥å…³äºæˆ‘ä»¬çš„å†…å®¹..."></textarea>
                                </div>
                                <button onclick="saveContent('about')" class="blue-button text-white px-4 py-2 rounded-lg">
                                    ğŸ’¾ ä¿å­˜å…³äºæˆ‘ä»¬
                                </button>
                            </div>
                        </div>

                        <!-- é¦–é¡µè‹±é›„åŒºåŸŸ -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <span class="text-2xl mr-2">ğŸ </span>
                                é¦–é¡µè‹±é›„åŒºåŸŸ
                            </h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">ä¸»æ ‡é¢˜</label>
                                    <input type="text" id="heroTitle" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">å‰¯æ ‡é¢˜</label>
                                    <input type="text" id="heroSubtitle" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">æè¿°</label>
                                    <textarea id="heroDescription" class="form-input form-textarea" rows="3"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">æŒ‰é’®æ–‡å­—</label>
                                    <input type="text" id="heroCtaText" class="form-input">
                                </div>
                                <button onclick="saveContent('homepage')" class="green-button text-white px-4 py-2 rounded-lg">
                                    ğŸ’¾ ä¿å­˜é¦–é¡µå†…å®¹
                                </button>
                            </div>
                        </div>

                        <!-- åº•éƒ¨ä¿¡æ¯ -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <span class="text-2xl mr-2">ğŸ¦¶</span>
                                åº•éƒ¨ä¿¡æ¯
                            </h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">ç‰ˆæƒä¿¡æ¯</label>
                                    <input type="text" id="footerCopyright" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">GitHubé“¾æ¥</label>
                                    <input type="url" id="githubUrl" class="form-input">
                                </div>
                                <button onclick="saveContent('footer')" class="mario-button text-white px-4 py-2 rounded-lg">
                                    ğŸ’¾ ä¿å­˜åº•éƒ¨ä¿¡æ¯
                                </button>
                            </div>
                        </div>

                        <!-- SEOè®¾ç½® -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h3 class="text-lg font-bold mb-4 flex items-center">
                                <span class="text-2xl mr-2">ğŸ”</span>
                                SEOè®¾ç½®
                            </h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">ç½‘ç«™æ ‡é¢˜ (Meta Title)</label>
                                    <input type="text" id="metaTitle" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ç½‘ç«™æè¿° (Meta Description)</label>
                                    <textarea id="metaDescription" class="form-input form-textarea" rows="3"></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">å…³é”®è¯ (Meta Keywords)</label>
                                    <input type="text" id="metaKeywords" class="form-input" placeholder="ç”¨é€—å·åˆ†éš”å…³é”®è¯">
                                </div>
                                <button onclick="saveContent('seo')" class="yellow-button text-white px-4 py-2 rounded-lg">
                                    ğŸ’¾ ä¿å­˜SEOè®¾ç½®
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-8 bg-blue-50 border-l-4 border-blue-400 p-4 rounded">
                        <div class="flex">
                            <div class="text-2xl mr-3">ğŸ’¡</div>
                            <div>
                                <p class="font-bold text-blue-800">ä½¿ç”¨æç¤º</p>
                                <ul class="text-blue-700 text-sm mt-2 list-disc list-inside space-y-1">
                                    <li>å…³äºæˆ‘ä»¬å†…å®¹æ”¯æŒHTMLæ ¼å¼ï¼Œå¯ä»¥æ·»åŠ é“¾æ¥ã€å›¾ç‰‡ç­‰å…ƒç´ </li>
                                    <li>SEOè®¾ç½®ä¼šå½±å“æœç´¢å¼•æ“å¯¹ç½‘ç«™çš„æ”¶å½•å’Œæ’å</li>
                                    <li>å»ºè®®å®šæœŸæ›´æ–°ç½‘ç«™å†…å®¹ä»¥ä¿æŒæ´»è·ƒåº¦</li>
                                    <li>ä¿®æ”¹åçš„å†…å®¹ä¼šç«‹å³ç”Ÿæ•ˆï¼Œæ— éœ€é‡å¯æœåŠ¡</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- å¼¹çª—é…ç½® -->
            <div id="popups-tab" class="tab-content hidden">
                <div class="max-w-6xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">ğŸ”” å¼¹çª—é…ç½®ç®¡ç†</h2>
                        <button onclick="showModal('popupModal')" class="blue-button text-white px-4 py-2 rounded-lg font-bold">
                            â• æ·»åŠ å¼¹çª—
                        </button>
                    </div>
                    
                    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded mb-6">
                        <div class="flex">
                            <div class="text-2xl mr-3">ğŸ’¡</div>
                            <div>
                                <p class="font-bold text-blue-800">å¼¹çª—åŠŸèƒ½è¯´æ˜</p>
                                <ul class="text-blue-700 text-sm mt-2 list-disc list-inside space-y-1">
                                    <li>æ”¯æŒæŒ‰IPåœ°å€æ¯å¤©é¦–æ¬¡è®¿é—®å¼¹å‡º</li>
                                    <li>å¯é…ç½®æ˜¾ç¤ºæ—¶é—´ã€ä½ç½®å’Œæ ·å¼</li>
                                    <li>æ”¯æŒå›¾ç‰‡ã€æ–‡æœ¬å’Œé“¾æ¥å†…å®¹</li>
                                    <li>å¯è®¾ç½®å¼¹çª—çš„å¯ç”¨çŠ¶æ€å’Œæœ‰æ•ˆæœŸ</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div id="popupsGrid" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- å¼¹çª—é…ç½®å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- æ‚¬æµ®å…ƒç´ é…ç½® -->
            <div id="floating-tab" class="tab-content hidden">
                <div class="max-w-6xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold">ğŸ“± æ‚¬æµ®å…ƒç´ é…ç½®</h2>
                        <button onclick="showModal('floatingModal')" class="blue-button text-white px-4 py-2 rounded-lg font-bold">
                            â• æ·»åŠ æ‚¬æµ®å…ƒç´ 
                        </button>
                    </div>
                    
                    <div class="bg-green-50 border-l-4 border-green-400 p-4 rounded mb-6">
                        <div class="flex">
                            <div class="text-2xl mr-3">ğŸ“Œ</div>
                            <div>
                                <p class="font-bold text-green-800">æ‚¬æµ®å…ƒç´ åŠŸèƒ½</p>
                                <ul class="text-green-700 text-sm mt-2 list-disc list-inside space-y-1">
                                    <li>æ”¯æŒäºŒç»´ç ã€ç¤¾äº¤é“¾æ¥ã€è”ç³»æ–¹å¼ç­‰</li>
                                    <li>å¯é…ç½®æ˜¾ç¤ºä½ç½®ï¼ˆå·¦ä¸Šã€å³ä¸Šã€å·¦ä¸‹ã€å³ä¸‹ï¼‰</li>
                                    <li>æ”¯æŒè‡ªå®šä¹‰å›¾æ ‡å’Œé¢œè‰²</li>
                                    <li>å¯è®¾ç½®ç‚¹å‡»è¡Œä¸ºï¼ˆé“¾æ¥è·³è½¬ã€æ˜¾ç¤ºäºŒç»´ç ç­‰ï¼‰</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div id="floatingElementsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- æ‚¬æµ®å…ƒç´ é…ç½®å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- ç½‘ç«™è®¾ç½® -->
            <div id="settings-tab" class="tab-content hidden">
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-bold mb-6">âš™ï¸ ç½‘ç«™è®¾ç½®</h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- åŸºæœ¬è®¾ç½® -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h3 class="text-lg font-bold mb-4">ğŸ  åŸºæœ¬è®¾ç½®</h3>
                            <div class="space-y-4">
                                <div class="form-group">
                                    <label class="form-label">ç½‘ç«™æ ‡é¢˜</label>
                                    <input type="text" id="siteTitle" class="form-input" value="Warp Zone Gems">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">ç½‘ç«™æè¿°</label>
                                    <textarea id="siteDescription" class="form-input" rows="3">é©¬é‡Œå¥¥ä¸»é¢˜æ¸¸æˆèµ„æºåˆ†äº«å¹³å°</textarea>
                                </div>
                            </div>
                        </div>

                        <!-- APIé…ç½® -->
                        <div class="bg-gray-50 p-6 rounded-lg">
                            <h3 class="text-lg font-bold mb-4">ğŸ”‘ APIé…ç½®çŠ¶æ€</h3>
                            <div class="space-y-4">
                                <div id="configStatus" class="text-sm text-gray-600">
                                    åŠ è½½é…ç½®ä¿¡æ¯ä¸­...
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-6 text-center">
                        <button onclick="saveSettings()" class="green-button text-white px-8 py-3 rounded-lg font-bold">
                            ğŸ’¾ ä¿å­˜è®¾ç½®
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å¼¹çª—é…ç½®æ¨¡æ€æ¡† -->
    <div id="popupModal" class="modal">
        <div class="modal-content w-full max-w-4xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">ğŸ”” é…ç½®å¼¹çª—</h3>
                <button onclick="hideModal('popupModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <form id="popupForm">
                <input type="hidden" id="popupId">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- å·¦åˆ— -->
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">å¼¹çª—æ ‡é¢˜ *</label>
                            <input type="text" id="popupTitle" class="form-input" required placeholder="æ¬¢è¿è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">å¼¹çª—ç±»å‹</label>
                            <select id="popupType" class="form-input">
                                <option value="welcome">æ¬¢è¿å¼¹çª—</option>
                                <option value="announcement">å…¬å‘Šå¼¹çª—</option>
                                <option value="promotion">æ¨å¹¿å¼¹çª—</option>
                                <option value="notification">é€šçŸ¥å¼¹çª—</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">æ˜¾ç¤ºä½ç½®</label>
                            <select id="popupPosition" class="form-input">
                                <option value="center">å±…ä¸­æ˜¾ç¤º</option>
                                <option value="top">é¡¶éƒ¨æ˜¾ç¤º</option>
                                <option value="bottom">åº•éƒ¨æ˜¾ç¤º</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">å¼¹çª—å›¾ç‰‡URL</label>
                            <input type="url" id="popupImage" class="form-input" placeholder="https://example.com/image.jpg">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">æŒ‰é’®æ–‡å­—</label>
                            <input type="text" id="popupButtonText" class="form-input" placeholder="äº†è§£æ›´å¤š">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">æŒ‰é’®é“¾æ¥</label>
                            <input type="url" id="popupButtonUrl" class="form-input" placeholder="https://example.com">
                        </div>
                    </div>
                    
                    <!-- å³åˆ— -->
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">å¼¹çª—å†…å®¹</label>
                            <textarea id="popupContent" class="form-input form-textarea" rows="6" placeholder="æ„Ÿè°¢æ‚¨è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™ï¼è¿™é‡Œæœ‰æœ€æ–°çš„é©¬é‡Œå¥¥æ¸¸æˆèµ„æº..."></textarea>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">æ˜¾ç¤ºå»¶è¿Ÿï¼ˆç§’ï¼‰</label>
                                <input type="number" id="popupDelay" class="form-input" min="0" value="2">
                            </div>
                            <div class="form-group">
                                <label class="form-label">è‡ªåŠ¨å…³é—­ï¼ˆç§’ï¼‰</label>
                                <input type="number" id="popupAutoClose" class="form-input" min="0" value="0" placeholder="0è¡¨ç¤ºä¸è‡ªåŠ¨å…³é—­">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">è§¦å‘é¢‘ç‡</label>
                            <select id="popupFrequency" class="form-input">
                                <option value="once">ä»…ä¸€æ¬¡</option>
                                <option value="daily">æ¯å¤©ä¸€æ¬¡</option>
                                <option value="session">æ¯æ¬¡ä¼šè¯</option>
                                <option value="always">æ¯æ¬¡è®¿é—®</option>
                            </select>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">å¼€å§‹æ—¥æœŸ</label>
                                <input type="date" id="popupStartDate" class="form-input">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ç»“æŸæ—¥æœŸ</label>
                                <input type="date" id="popupEndDate" class="form-input">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="flex items-center">
                                <input type="checkbox" id="popupEnabled" class="mr-2">
                                <span>å¯ç”¨è¿™ä¸ªå¼¹çª—</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 mt-8 pt-6 border-t border-gray-200">
                    <button type="button" onclick="hideModal('popupModal')" class="mario-button text-white px-6 py-2 rounded-lg">
                        å–æ¶ˆ
                    </button>
                    <button type="submit" class="green-button text-white px-6 py-2 rounded-lg">
                        ä¿å­˜å¼¹çª—
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- æ‚¬æµ®å…ƒç´ é…ç½®æ¨¡æ€æ¡† -->
    <div id="floatingModal" class="modal">
        <div class="modal-content w-full max-w-3xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">ğŸ“± é…ç½®æ‚¬æµ®å…ƒç´ </h3>
                <button onclick="hideModal('floatingModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <form id="floatingForm">
                <input type="hidden" id="floatingId">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- å·¦åˆ— -->
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">å…ƒç´ æ ‡é¢˜ *</label>
                            <input type="text" id="floatingTitle" class="form-input" required placeholder="è”ç³»æˆ‘ä»¬">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">å…ƒç´ ç±»å‹</label>
                            <select id="floatingType" class="form-input">
                                <option value="qrcode">äºŒç»´ç </option>
                                <option value="social">ç¤¾äº¤é“¾æ¥</option>
                                <option value="contact">è”ç³»æ–¹å¼</option>
                                <option value="download">ä¸‹è½½é“¾æ¥</option>
                                <option value="custom">è‡ªå®šä¹‰</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">æ˜¾ç¤ºä½ç½®</label>
                            <select id="floatingPosition" class="form-input">
                                <option value="bottom-right">å³ä¸‹è§’</option>
                                <option value="bottom-left">å·¦ä¸‹è§’</option>
                                <option value="top-right">å³ä¸Šè§’</option>
                                <option value="top-left">å·¦ä¸Šè§’</option>
                                <option value="center-right">å³ä¾§å±…ä¸­</option>
                                <option value="center-left">å·¦ä¾§å±…ä¸­</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">å›¾æ ‡</label>
                            <input type="text" id="floatingIcon" class="form-input" placeholder="ğŸ“±, ğŸ’¬, ğŸ“§, ğŸ”—ç­‰">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">èƒŒæ™¯é¢œè‰²</label>
                            <input type="color" id="floatingBgColor" class="form-input" value="#007bff">
                        </div>
                    </div>
                    
                    <!-- å³åˆ— -->
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">ç‚¹å‡»è¡Œä¸º</label>
                            <select id="floatingAction" class="form-input">
                                <option value="link">æ‰“å¼€é“¾æ¥</option>
                                <option value="popup">æ˜¾ç¤ºå¼¹çª—</option>
                                <option value="download">ä¸‹è½½æ–‡ä»¶</option>
                                <option value="copy">å¤åˆ¶æ–‡æœ¬</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">é“¾æ¥åœ°å€/å†…å®¹</label>
                            <textarea id="floatingContent" class="form-input form-textarea" rows="3" placeholder="https://example.com æˆ–è€…è¦æ˜¾ç¤ºçš„å†…å®¹"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">äºŒç»´ç å›¾ç‰‡URLï¼ˆå¦‚æœæ˜¯äºŒç»´ç ç±»å‹ï¼‰</label>
                            <input type="url" id="floatingQRCode" class="form-input" placeholder="https://example.com/qrcode.jpg">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">å¤§å°</label>
                                <select id="floatingSize" class="form-input">
                                    <option value="small">å°</option>
                                    <option value="medium">ä¸­</option>
                                    <option value="large">å¤§</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">å±‚çº§</label>
                                <input type="number" id="floatingZIndex" class="form-input" min="1" max="9999" value="1000">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="flex items-center">
                                <input type="checkbox" id="floatingEnabled" class="mr-2">
                                <span>å¯ç”¨è¿™ä¸ªæ‚¬æµ®å…ƒç´ </span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 mt-8 pt-6 border-t border-gray-200">
                    <button type="button" onclick="hideModal('floatingModal')" class="mario-button text-white px-6 py-2 rounded-lg">
                        å–æ¶ˆ
                    </button>
                    <button type="submit" class="green-button text-white px-6 py-2 rounded-lg">
                        ä¿å­˜æ‚¬æµ®å…ƒç´ 
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- æ¸¸æˆç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="gameModal" class="modal">
        <div class="modal-content w-full max-w-4xl">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold">ğŸ® ç¼–è¾‘æ¸¸æˆ</h3>
                <button onclick="hideModal('gameModal')" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
            </div>
            <form id="gameForm">
                <input type="hidden" id="gameId">
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- å·¦åˆ— -->
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">æ¸¸æˆæ ‡é¢˜ *</label>
                            <input type="text" id="gameTitle" class="form-input" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">åˆ†ç±»</label>
                            <select id="gameCategory" class="form-input">
                                <option value="å¹³å°è·³è·ƒ">å¹³å°è·³è·ƒ</option>
                                <option value="èµ›è½¦ç«é€Ÿ">èµ›è½¦ç«é€Ÿ</option>
                                <option value="è§’è‰²æ‰®æ¼”">è§’è‰²æ‰®æ¼”</option>
                                <option value="æ´¾å¯¹æ¸¸æˆ">æ´¾å¯¹æ¸¸æˆ</option>
                                <option value="ä½“æ„Ÿè¿åŠ¨">ä½“æ„Ÿè¿åŠ¨</option>
                                <option value="è§£è°œç›Šæ™º">è§£è°œç›Šæ™º</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">å°é¢å›¾ç‰‡</label>
                            <div class="space-y-3">
                                <input type="url" id="gameCoverImage" class="form-input" placeholder="è¾“å…¥å›¾ç‰‡URLæˆ–ä¸Šä¼ å›¾ç‰‡">
                                <div class="flex items-center space-x-2">
                                    <input type="file" id="imageFileInput" accept="image/*" class="hidden">
                                    <button type="button" onclick="document.getElementById('imageFileInput').click()" 
                                            class="blue-button text-white px-3 py-2 rounded text-sm">
                                        ğŸ“ é€‰æ‹©å›¾ç‰‡
                                    </button>
                                    <button type="button" onclick="uploadImage()" id="uploadBtn" 
                                            class="green-button text-white px-3 py-2 rounded text-sm" disabled>
                                        â¬†ï¸ ä¸Šä¼ å›¾ç‰‡
                                    </button>
                                    <span id="uploadStatus" class="text-sm text-gray-500"></span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ä¸‹è½½é“¾æ¥</label>
                            <div id="downloadLinksContainer" class="space-y-3">
                                <!-- åŠ¨æ€ç”Ÿæˆçš„ä¸‹è½½é“¾æ¥å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                            </div>
                            <div class="flex space-x-2 mt-2">
                                <button type="button" onclick="addDownloadLink()" class="blue-button text-white px-3 py-2 rounded text-sm">
                                    â• æ·»åŠ ä¸‹è½½é“¾æ¥
                                </button>
                                <button type="button" onclick="previewDownloadLinks()" class="green-button text-white px-3 py-2 rounded text-sm">
                                    ğŸ‘ï¸ é¢„è§ˆæ•ˆæœ
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">çŠ¶æ€</label>
                            <select id="gameStatus" class="form-input">
                                <option value="draft">è‰ç¨¿</option>
                                <option value="published">å·²å‘å¸ƒ</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- å³åˆ— -->
                    <div class="space-y-4">
                        <div class="form-group">
                            <label class="form-label">æ¸¸æˆæè¿°</label>
                            <textarea id="gameDescription" class="form-input form-textarea" rows="6" placeholder="è¯·è¾“å…¥æ¸¸æˆçš„è¯¦ç»†æè¿°..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</label>
                            <input type="text" id="gameTags" class="form-input" placeholder="é©¬é‡Œå¥¥,ç»å…¸,å¹³å°">
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="form-group">
                                <label class="form-label">æµè§ˆé‡</label>
                                <input type="number" id="gameViewCount" class="form-input" min="0" value="0">
                            </div>
                            <div class="form-group">
                                <label class="form-label">ä¸‹è½½é‡</label>
                                <input type="number" id="gameDownloadCount" class="form-input" min="0" value="0">
                            </div>
                        </div>
                        
                        <!-- å›¾ç‰‡é¢„è§ˆ -->
                        <div class="form-group">
                            <label class="form-label">å°é¢é¢„è§ˆ</label>
                            <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center bg-gray-50">
                                <img id="imagePreview" src="" alt="å°é¢é¢„è§ˆ" 
                                     class="w-32 h-32 object-cover mx-auto rounded-lg mb-2 bg-white shadow-sm"
                                     onerror="this.src='data:image/svg+xml;charset=utf8,' + encodeURIComponent(`
                                        <svg xmlns='http://www.w3.org/2000/svg' width='128' height='128' viewBox='0 0 128 128'>
                                            <rect width='128' height='128' fill='#f9fafb' stroke='#d1d5db' stroke-width='2'/>
                                            <circle cx='64' cy='50' r='15' fill='#ef4444'/>
                                            <rect x='49' y='70' width='30' height='20' rx='3' fill='#ef4444'/>
                                            <text x='64' y='105' font-family='Arial' font-size='12' fill='#ef4444' text-anchor='middle'>Error</text>
                                        </svg>
                                     `)">
                                <p class="text-sm text-gray-500">å®æ—¶é¢„è§ˆ - æ”¯æŒæ‹–æ‹½ä¸Šä¼ </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-4 mt-8 pt-6 border-t border-gray-200">
                    <button type="button" onclick="hideModal('gameModal')" class="mario-button text-white px-6 py-2 rounded-lg">
                        å–æ¶ˆ
                    </button>
                    <button type="submit" class="green-button text-white px-6 py-2 rounded-lg">
                        ä¿å­˜æ¸¸æˆ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentTab = 'dashboard';
        let currentGameView = 'published';
        let gamesData = [];
        let categoriesData = [];
        let appConfig = {};
        let websiteContent = {};
        let popupsData = [];
        let floatingElementsData = [];
        let currentDownloadLinks = []; // å½“å‰ç¼–è¾‘çš„æ¸¸æˆä¸‹è½½é“¾æ¥

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initTabs();
            loadConfig();
            loadSystemStatus();
            loadAllData();
            loadWebsiteContent();
            initGameForm();
            initPopupForm();
            initFloatingForm();
            loadPublishStatus();
        });

        // åŠ è½½é…ç½®
        async function loadConfig() {
            try {
                const response = await fetch('/api/config');
                const result = await response.json();
                
                if (result.success) {
                    appConfig = result.data;
                    updateConfigDisplay();
                }
            } catch (error) {
                console.error('åŠ è½½é…ç½®å¤±è´¥:', error);
            }
        }

        // æ›´æ–°é…ç½®æ˜¾ç¤º
        function updateConfigDisplay() {
            const hasApiKey = appConfig.siliconFlow?.hasApiKey;
            const apiKeyStatus = document.getElementById('apiKeyStatus');
            const apiKeyNotice = document.getElementById('apiKeyNotice');
            const configStatus = document.getElementById('configStatus');
            const apiConfigStatus = document.getElementById('apiConfigStatus');

            if (hasApiKey) {
                apiKeyStatus.innerHTML = `
                    <span class="w-2 h-2 rounded-full bg-green-500 inline-block mr-2"></span>
                    <span>APIå·²é…ç½®</span>
                `;
                
                apiKeyNotice.className = "bg-green-50 border-l-4 border-green-400 p-4 mb-6";
                apiKeyNotice.innerHTML = `
                    <div class="flex">
                        <div class="text-2xl mr-3">âœ…</div>
                        <div>
                            <p class="font-bold text-green-800">API Keyå·²é…ç½®</p>
                            <p class="text-green-700">ä½¿ç”¨é…ç½®æ–‡ä»¶ä¸­çš„Silicon Flow API Keyï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥</p>
                        </div>
                    </div>
                `;

                apiConfigStatus.textContent = 'âœ… å·²é…ç½®';
                
                configStatus.innerHTML = `
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span>Silicon Flow API:</span>
                            <span class="text-green-600">âœ… å·²é…ç½®</span>
                        </div>
                        <div class="flex justify-between">
                            <span>é»˜è®¤æ¨¡å‹:</span>
                            <span class="text-blue-600">${appConfig.siliconFlow.defaultModel}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>æ‰¹å¤„ç†å¤§å°:</span>
                            <span class="text-blue-600">${appConfig.siliconFlow.batchSize}</span>
                        </div>
                    </div>
                `;
            } else {
                apiKeyStatus.innerHTML = `
                    <span class="w-2 h-2 rounded-full bg-red-500 inline-block mr-2"></span>
                    <span>APIæœªé…ç½®</span>
                `;
                
                apiKeyNotice.className = "bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6";
                apiKeyNotice.innerHTML = `
                    <div class="flex">
                        <div class="text-2xl mr-3">âš ï¸</div>
                        <div>
                            <p class="font-bold text-yellow-800">API Keyæœªé…ç½®</p>
                            <p class="text-yellow-700">è¯·åœ¨ä¸‹æ–¹æ‰‹åŠ¨è¾“å…¥API Keyæˆ–åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®</p>
                        </div>
                    </div>
                `;

                apiConfigStatus.textContent = 'âŒ æœªé…ç½®';
                
                configStatus.innerHTML = `
                    <div class="text-yellow-600">
                        <p>âš ï¸ API Keyæœªåœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½®</p>
                        <p class="text-xs mt-1">è¯·åœ¨ admin/config.json ä¸­é…ç½® siliconFlow.apiKey</p>
                    </div>
                `;
            }

            // è®¾ç½®é»˜è®¤æ¨¡å‹
            if (appConfig.siliconFlow?.defaultModel) {
                document.getElementById('aiModel').value = appConfig.siliconFlow.defaultModel;
            }
        }

        // æ ‡ç­¾é¡µç®¡ç†
        function initTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    switchTab(tabName);
                });
            });
        }

        function switchTab(tabName) {
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('tab-active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('tab-active');

            // æ›´æ–°å†…å®¹æ˜¾ç¤º
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');

            currentTab = tabName;

            // åŠ è½½å¯¹åº”æ•°æ®
            switch(tabName) {
                case 'games':
                    loadGamesData();
                    break;
                case 'banners':
                    loadBannersData();
                    break;
                case 'content':
                    loadWebsiteContent();
                    break;
                case 'popups':
                    loadPopupsData();
                    break;
                case 'floating':
                    loadFloatingElementsData();
                    break;
            }
        }

        // ç³»ç»ŸçŠ¶æ€
        async function loadSystemStatus() {
            try {
                const response = await fetch('/api/status');
                const result = await response.json();
                
                if (result.success) {
                    const data = result.data;
                    document.getElementById('gamesCount').textContent = data.gamesCount;
                    document.getElementById('totalViews').textContent = data.totalViews.toLocaleString();
                    document.getElementById('totalDownloads').textContent = data.totalDownloads.toLocaleString();
                    document.getElementById('categoriesCount').textContent = data.categoriesCount;
                    document.getElementById('nodeVersion').textContent = data.nodeVersion;
                    document.getElementById('gitStatus').textContent = data.gitStatus;
                }
            } catch (error) {
                console.error('åŠ è½½ç³»ç»ŸçŠ¶æ€å¤±è´¥:', error);
            }
        }

        // æ•°æ®åŠ è½½
        async function loadAllData() {
            await Promise.all([
                loadGamesData(),
                loadCategoriesData(),
                loadBannersData()
            ]);
        }

        async function loadGamesData() {
            try {
                console.log('å¼€å§‹åŠ è½½æ¸¸æˆæ•°æ®...');
                const response = await fetch('/api/data/games');
                const result = await response.json();
                
                console.log('APIå“åº”:', result);
                
                if (result.success) {
                    gamesData = result.data || [];
                    console.log('æ¸¸æˆæ•°æ®å·²åŠ è½½:', gamesData.length, 'ä¸ªæ¸¸æˆ');
                    renderAllGameViews();
                    updateDraftsCount();
                } else {
                    console.error('APIè¿”å›å¤±è´¥:', result);
                }
            } catch (error) {
                console.error('åŠ è½½æ¸¸æˆæ•°æ®å¤±è´¥:', error);
            }
        }

        async function loadCategoriesData() {
            try {
                const response = await fetch('/api/data/categories');
                const result = await response.json();
                
                if (result.success) {
                    categoriesData = result.data || [];
                    renderCategoriesView();
                }
            } catch (error) {
                console.error('åŠ è½½åˆ†ç±»æ•°æ®å¤±è´¥:', error);
            }
        }

        async function loadBannersData() {
            try {
                const response = await fetch('/api/data/banners');
                const result = await response.json();
                
                if (result.success) {
                    renderBannersGrid(result.data || []);
                }
            } catch (error) {
                console.error('åŠ è½½Banneræ•°æ®å¤±è´¥:', error);
                renderBannersGrid([]);
            }
        }

        // æ¸¸æˆè§†å›¾åˆ‡æ¢
        function switchGameView(view) {
            currentGameView = view;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.view-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-view="${view}"]`).classList.add('active');
            
            // åˆ‡æ¢è§†å›¾
            document.querySelectorAll('.game-view').forEach(viewEl => {
                viewEl.classList.add('hidden');
            });
            document.getElementById(`${view}View`).classList.remove('hidden');
            
            // åŠ è½½å¯¹åº”æ•°æ®
            if (view === 'categories') {
                loadCategoriesData();
            }
        }

        // æ›´æ–°è‰ç¨¿æ•°é‡
        function updateDraftsCount() {
            const draftsCount = gamesData.filter(game => game.status === 'draft').length;
            document.getElementById('draftsCount').textContent = draftsCount;
        }

        // æ¸²æŸ“æ‰€æœ‰æ¸¸æˆè§†å›¾
        function renderAllGameViews() {
            renderPublishedGames();
            renderDraftsGames();
            renderCategoriesView();
        }

        // æ¸²æŸ“å·²å‘å¸ƒæ¸¸æˆ
        function renderPublishedGames() {
            console.log('renderPublishedGames è¢«è°ƒç”¨');
            const container = document.getElementById('publishedGamesGrid');
            console.log('å®¹å™¨å…ƒç´ :', container);
            
            const publishedGames = gamesData.filter(game => game.status === 'published');
            console.log('å·²å‘å¸ƒæ¸¸æˆæ•°é‡:', publishedGames.length);
            console.log('å·²å‘å¸ƒæ¸¸æˆ:', publishedGames);
            
            if (publishedGames.length === 0) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">æš‚æ— å·²å‘å¸ƒçš„æ¸¸æˆ</div>';
                return;
            }

            try {
                const html = publishedGames.map(game => renderGameItem(game)).join('');
                console.log('ç”Ÿæˆçš„HTMLé•¿åº¦:', html.length);
                container.innerHTML = html;
                console.log('å·²å‘å¸ƒæ¸¸æˆæ¸²æŸ“å®Œæˆ');
            } catch (error) {
                console.error('æ¸²æŸ“å·²å‘å¸ƒæ¸¸æˆæ—¶å‡ºé”™:', error);
                container.innerHTML = '<div class="text-center py-8 text-red-500">æ¸²æŸ“å‡ºé”™: ' + error.message + '</div>';
            }
        }

        // æ¸²æŸ“è‰ç¨¿æ¸¸æˆ
        function renderDraftsGames() {
            const container = document.getElementById('draftsGrid');
            const draftGames = gamesData.filter(game => game.status === 'draft');
            
            if (draftGames.length === 0) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">æš‚æ— è‰ç¨¿æ¸¸æˆ</div>';
                return;
            }

            container.innerHTML = draftGames.map(game => renderGameItem(game)).join('');
        }

        // æ¸²æŸ“å•ä¸ªæ¸¸æˆé¡¹ç›®
        function renderGameItem(game) {
            const statusClass = game.status === 'published' ? 'published' : 'draft';
            const statusText = game.status === 'published' ? 'å·²å‘å¸ƒ' : 'è‰ç¨¿';
            const statusBadgeClass = game.status === 'published' ? 'status-published' : 'status-draft';
            
            // åˆ›å»ºå ä½ç¬¦å›¾ç‰‡ (ä½¿ç”¨URLç¼–ç é¿å…btoaä¸­æ–‡é—®é¢˜)
            const placeholderSvg = `data:image/svg+xml;charset=utf8,${encodeURIComponent(`
                <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80">
                    <rect width="80" height="80" fill="#f3f4f6" stroke="#d1d5db"/>
                    <circle cx="40" cy="30" r="8" fill="#6b7280"/>
                    <rect x="32" y="45" width="16" height="10" rx="2" fill="#6b7280"/>
                    <text x="40" y="65" font-family="Arial" font-size="8" fill="#6b7280" text-anchor="middle">Game Cover</text>
                </svg>
            `)}`;
            
            const errorSvg = `data:image/svg+xml;charset=utf8,${encodeURIComponent(`
                <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 80 80">
                    <rect width="80" height="80" fill="#fef2f2" stroke="#fecaca"/>
                    <path d="M40 20 L50 35 L30 35 Z" fill="#ef4444"/>
                    <text x="40" y="42" font-family="Arial" font-size="14" fill="#ef4444" text-anchor="middle">!</text>
                    <text x="40" y="65" font-family="Arial" font-size="8" fill="#ef4444" text-anchor="middle">Load Failed</text>
                </svg>
            `)}`;
            
            const imageUrl = game.cover_image && game.cover_image !== '/placeholder.svg' ? 
                game.cover_image : placeholderSvg;
            
            return `
                <div class="game-item ${statusClass}">
                    <div class="flex items-start space-x-4">
                        <img src="${imageUrl}" alt="${game.title}" 
                             class="w-20 h-20 object-cover rounded-lg flex-shrink-0 bg-gray-100"
                             onerror="this.src='${errorSvg}'">
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start justify-between">
                                <div class="flex-1">
                                    <h3 class="font-bold text-lg text-gray-900 truncate">${game.title}</h3>
                                    <p class="text-sm text-gray-600 mb-2">${game.category}</p>
                                    <p class="text-sm text-gray-500 line-clamp-2">${game.description || 'æš‚æ— æè¿°'}</p>
                                </div>
                                <span class="status-badge ${statusBadgeClass} ml-2">${statusText}</span>
                            </div>
                            <div class="flex items-center justify-between mt-4">
                                <div class="flex space-x-4 text-xs text-gray-500">
                                    <span>ğŸ‘ï¸ ${game.view_count || 0}</span>
                                    <span>â¬‡ï¸ ${game.download_count || 0}</span>
                                    <span>ğŸ”— ${game.download_links ? game.download_links.length : (game.download_link && game.download_link !== '#' ? 1 : 0)} ä¸ªä¸‹è½½</span>
                                    <span>ğŸ“… ${game.created_at ? new Date(game.created_at).toLocaleDateString() : '-'}</span>
                                </div>
                                <div class="flex space-x-2 flex-wrap gap-1">
                                    <button onclick="navigateToFrontend('${game.id}')" 
                                            class="green-button text-white px-3 py-1 rounded text-sm">
                                        ğŸŒ æŸ¥çœ‹å‰ç«¯
                                    </button>
                                    <button onclick="editGame('${game.id}')" 
                                            class="blue-button text-white px-3 py-1 rounded text-sm">
                                        âœï¸ ç¼–è¾‘
                                    </button>
                                    ${game.status === 'draft' ? `
                                        <button onclick="enhanceWithAI('${game.id}')" 
                                                class="blue-button text-white px-3 py-1 rounded text-sm">
                                            ğŸ¤– AIä¼˜åŒ–
                                        </button>
                                        <button onclick="publishGame('${game.id}')" 
                                                class="green-button text-white px-3 py-1 rounded text-sm">
                                            ğŸ“¢ å‘å¸ƒ
                                        </button>
                                    ` : `
                                        <button onclick="unpublishGame('${game.id}')" 
                                                class="yellow-button text-white px-3 py-1 rounded text-sm">
                                            ğŸ“ æ’¤å›
                                        </button>
                                    `}
                                    <button onclick="deleteGame('${game.id}')" 
                                            class="mario-button text-white px-3 py-1 rounded text-sm">
                                        ğŸ—‘ï¸ åˆ é™¤
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // æ¸²æŸ“åˆ†ç±»è§†å›¾
        function renderCategoriesView() {
            const container = document.getElementById('categoriesAccordion');
            
            if (!categoriesData || categoriesData.length === 0) {
                container.innerHTML = '<div class="text-center py-8 text-gray-500">æš‚æ— åˆ†ç±»æ•°æ®</div>';
                return;
            }

            container.innerHTML = categoriesData.map(category => {
                const categoryGames = gamesData.filter(game => game.category === category.name);
                
                return `
                    <div class="category-item">
                        <div class="category-header" onclick="toggleCategory('${category.id}')">
                            <div class="flex items-center space-x-3">
                                <span class="text-2xl">${category.icon || 'ğŸ“'}</span>
                                <div>
                                    <h3 class="font-bold">${category.name}</h3>
                                    <p class="text-sm opacity-90">${category.description || ''}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-2">
                                <span class="bg-white bg-opacity-20 px-2 py-1 rounded-full text-sm">
                                    ${categoryGames.length} ä¸ªæ¸¸æˆ
                                </span>
                                <span class="category-arrow">â–¼</span>
                            </div>
                        </div>
                        <div class="category-content" id="category-${category.id}">
                            ${categoryGames.length > 0 ? 
                                categoryGames.map(game => renderGameItem(game)).join('') :
                                '<p class="text-gray-500 text-center py-4">è¯¥åˆ†ç±»ä¸‹æš‚æ— æ¸¸æˆ</p>'
                            }
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderBannersGrid(bannersData) {
            const grid = document.getElementById('bannersGrid');
            if (!bannersData || bannersData.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-8 text-gray-500">æš‚æ— Banneræ•°æ®</div>';
                return;
            }

            grid.innerHTML = bannersData.map(banner => `
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <img src="${banner.imageUrl}" alt="${banner.title}" class="w-full h-32 object-cover">
                    <div class="p-4">
                        <h3 class="font-bold mb-2">${banner.title}</h3>
                        <p class="text-xs text-gray-500 mb-3">ä½ç½®: ${banner.position} | çŠ¶æ€: ${banner.status}</p>
                    </div>
                </div>
            `).join('');
        }

        // AIåŠŸèƒ½
        async function testApiKey() {
            const apiKey = document.getElementById('apiKey').value;
            const model = document.getElementById('aiModel').value;

            try {
                const response = await fetch('/api/ai/test', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ apiKey, model })
                });

                const result = await response.json();
                if (result.success) {
                    showToast('APIé…ç½®æµ‹è¯•æˆåŠŸï¼', 'success');
                } else {
                    showToast('APIé…ç½®æµ‹è¯•å¤±è´¥: ' + result.error, 'error');
                }
            } catch (error) {
                showToast('æµ‹è¯•å¤±è´¥: ' + error.message, 'error');
            }
        }

        async function testApiConnection() {
            await testApiKey();
        }

        async function startAIProcessing() {
            const apiKey = document.getElementById('apiKey').value;
            const model = document.getElementById('aiModel').value;
            const inputText = document.getElementById('inputText').value;

            if (!inputText.trim()) {
                showToast('è¯·è¾“å…¥æ¸¸æˆä¿¡æ¯', 'error');
                return;
            }

            // æ˜¾ç¤ºè¿›åº¦åŒºåŸŸ
            document.getElementById('progressSection').classList.remove('hidden');
            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('progressText').textContent = 'æ­£åœ¨å¤„ç†...';
            document.getElementById('progressBar').style.width = '50%';

            try {
                const response = await fetch('/api/ai/process', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ apiKey, model, inputText })
                });

                const result = await response.json();
                
                // éšè—è¿›åº¦åŒºåŸŸ
                document.getElementById('progressSection').classList.add('hidden');
                
                if (result.success) {
                    // æ˜¾ç¤ºå¤„ç†ç»“æœ
                    document.getElementById('resultSection').classList.remove('hidden');
                    document.getElementById('resultContent').innerHTML = `
                        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-4">
                            <h4 class="font-bold text-green-800 mb-2">âœ… å¤„ç†å®Œæˆ</h4>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                                <div class="text-center">
                                    <div class="font-bold text-2xl text-blue-600">${result.data.processed}</div>
                                    <div class="text-gray-600">æ€»å¤„ç†</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-bold text-2xl text-green-600">${result.data.successful}</div>
                                    <div class="text-gray-600">æˆåŠŸ</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-bold text-2xl text-red-600">${result.data.failed}</div>
                                    <div class="text-gray-600">å¤±è´¥</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-bold text-2xl text-purple-600">${result.data.totalGames}</div>
                                    <div class="text-gray-600">æ€»æ¸¸æˆæ•°</div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // åˆ·æ–°æ¸¸æˆæ•°æ®
                    loadGamesData();
                    loadSystemStatus();
                    
                    showToast('AIå¤„ç†å®Œæˆï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                document.getElementById('progressSection').classList.add('hidden');
                showToast('å¤„ç†å¤±è´¥: ' + error.message, 'error');
            }
        }

        function clearInput() {
            document.getElementById('inputText').value = '';
            document.getElementById('progressSection').classList.add('hidden');
            document.getElementById('resultSection').classList.add('hidden');
        }

        // æ¸¸æˆç®¡ç†åŠŸèƒ½
        function initGameForm() {
            // ç»‘å®šè¡¨å•æäº¤äº‹ä»¶
            document.getElementById('gameForm').addEventListener('submit', saveGame);
            
            // ç»‘å®šå›¾ç‰‡é¢„è§ˆ
            document.getElementById('gameCoverImage').addEventListener('input', function() {
                updateImagePreview(this.value);
            });
            
            // ç»‘å®šæ–‡ä»¶é€‰æ‹©
            document.getElementById('imageFileInput').addEventListener('change', function() {
                const file = this.files[0];
                if (file) {
                    // æ˜¾ç¤ºæ–‡ä»¶é¢„è§ˆ
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        updateImagePreview(e.target.result);
                    };
                    reader.readAsDataURL(file);
                    
                    // å¯ç”¨ä¸Šä¼ æŒ‰é’®
                    document.getElementById('uploadBtn').disabled = false;
                    document.getElementById('uploadStatus').textContent = `å·²é€‰æ‹©: ${file.name}`;
                }
            });
        }
        
        function updateImagePreview(src) {
            const preview = document.getElementById('imagePreview');
            if (src) {
                preview.src = src;
            } else {
                preview.src = `data:image/svg+xml;charset=utf8,${encodeURIComponent(`
                    <svg xmlns="http://www.w3.org/2000/svg" width="128" height="128" viewBox="0 0 128 128">
                        <rect width="128" height="128" fill="#f9fafb" stroke="#d1d5db" stroke-width="2"/>
                        <circle cx="64" cy="50" r="15" fill="#d1d5db"/>
                        <rect x="49" y="70" width="30" height="20" rx="3" fill="#d1d5db"/>
                        <text x="64" y="105" font-family="Arial" font-size="12" fill="#6b7280" text-anchor="middle">No Image</text>
                    </svg>
                `)}`;
            }
        }
        
        // å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½
        async function uploadImage() {
            const fileInput = document.getElementById('imageFileInput');
            const file = fileInput.files[0];
            const statusEl = document.getElementById('uploadStatus');
            const uploadBtn = document.getElementById('uploadBtn');
            
            if (!file) {
                showToast('è¯·å…ˆé€‰æ‹©å›¾ç‰‡æ–‡ä»¶', 'error');
                return;
            }
            
            // æ£€æŸ¥æ–‡ä»¶å¤§å° (æœ€å¤§5MB)
            if (file.size > 5 * 1024 * 1024) {
                showToast('å›¾ç‰‡æ–‡ä»¶è¿‡å¤§ï¼Œè¯·é€‰æ‹©å°äº5MBçš„å›¾ç‰‡', 'error');
                return;
            }
            
            uploadBtn.disabled = true;
            statusEl.textContent = 'æ­£åœ¨ä¸Šä¼ ...';
            
            try {
                const formData = new FormData();
                formData.append('image', file);
                
                const response = await fetch('/api/upload-image', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // ä¸Šä¼ æˆåŠŸï¼Œæ›´æ–°å›¾ç‰‡URL
                    document.getElementById('gameCoverImage').value = result.data.url;
                    updateImagePreview(result.data.url);
                    statusEl.textContent = 'ä¸Šä¼ æˆåŠŸï¼';
                    showToast('å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error || 'ä¸Šä¼ å¤±è´¥');
                }
            } catch (error) {
                console.error('å›¾ç‰‡ä¸Šä¼ å¤±è´¥:', error);
                statusEl.textContent = 'ä¸Šä¼ å¤±è´¥';
                showToast('å›¾ç‰‡ä¸Šä¼ å¤±è´¥: ' + error.message, 'error');
            } finally {
                uploadBtn.disabled = false;
                // æ¸…ç©ºæ–‡ä»¶é€‰æ‹©
                setTimeout(() => {
                    uploadBtn.disabled = true;
                    statusEl.textContent = '';
                }, 3000);
            }
        }

        // ä¸‹è½½é“¾æ¥ç®¡ç†åŠŸèƒ½
        const CLOUD_SERVICES = [
            { id: 'ç™¾åº¦ç½‘ç›˜', name: 'ç™¾åº¦ç½‘ç›˜', icon: 'ğŸ“' },
            { id: 'å¤©ç¿¼äº‘ç›˜', name: 'å¤©ç¿¼äº‘ç›˜', icon: 'â˜ï¸' },
            { id: 'é˜¿é‡Œäº‘ç›˜', name: 'é˜¿é‡Œäº‘ç›˜', icon: 'ğŸ’¾' },
            { id: 'å¾®äº‘', name: 'å¾®äº‘', icon: 'ğŸ“¦' },
            { id: '115ç½‘ç›˜', name: '115ç½‘ç›˜', icon: 'ğŸ’½' },
            { id: 'è“å¥äº‘', name: 'è“å¥äº‘', icon: 'ğŸŒ' },
            { id: 'other', name: 'å…¶ä»–', icon: 'ğŸ”—' }
        ];

        function addDownloadLink() {
            const linkId = 'link_' + Date.now() + '_' + Math.random().toString(36).substr(2, 5);
            const newLink = {
                id: linkId,
                service: 'other',
                url: '',
                password: '',
                label: 'ä¸‹è½½é“¾æ¥'
            };
            
            currentDownloadLinks.push(newLink);
            renderDownloadLinks();
        }

        function removeDownloadLink(linkId) {
            currentDownloadLinks = currentDownloadLinks.filter(link => link.id !== linkId);
            renderDownloadLinks();
        }

        function updateDownloadLink(linkId, field, value) {
            const link = currentDownloadLinks.find(l => l.id === linkId);
            if (link) {
                link[field] = value;
                
                // å¦‚æœæ˜¯æœåŠ¡ç±»å‹å˜æ›´ï¼Œæ›´æ–°å›¾æ ‡å’Œé»˜è®¤æ ‡ç­¾
                if (field === 'service') {
                    const service = CLOUD_SERVICES.find(s => s.id === value);
                    if (service && !link.label.includes(service.name)) {
                        link.label = service.name + 'ä¸‹è½½';
                    }
                }
                
                renderDownloadLinks();
            }
        }

        function renderDownloadLinks() {
            const container = document.getElementById('downloadLinksContainer');
            
            if (currentDownloadLinks.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-4 text-gray-500 border-2 border-dashed border-gray-300 rounded-lg">
                        <p>æš‚æ— ä¸‹è½½é“¾æ¥</p>
                        <p class="text-sm">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ä¸‹è½½é“¾æ¥</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = currentDownloadLinks.map((link, index) => {
                const service = CLOUD_SERVICES.find(s => s.id === link.service);
                return `
                    <div class="download-link-item" data-link-id="${link.id}">
                        <button type="button" class="remove-link-btn" onclick="removeDownloadLink('${link.id}')" title="åˆ é™¤æ­¤é“¾æ¥">Ã—</button>
                        
                        <div class="mb-3">
                            <label class="form-label text-sm">å­˜å‚¨æœåŠ¡</label>
                            <div class="service-selector">
                                ${CLOUD_SERVICES.map(s => `
                                    <div class="service-option ${s.id === link.service ? 'selected' : ''}" 
                                         onclick="updateDownloadLink('${link.id}', 'service', '${s.id}')">
                                        <div>${s.icon}</div>
                                        <div>${s.name}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                                <label class="form-label text-sm">é“¾æ¥åœ°å€ *</label>
                                <input type="url" class="form-input text-sm" placeholder="https://pan.baidu.com/s/..."
                                       value="${link.url || ''}"
                                       onchange="updateDownloadLink('${link.id}', 'url', this.value)">
                            </div>
                            <div>
                                <label class="form-label text-sm">æå–ç /å¯†ç </label>
                                <input type="text" class="form-input text-sm" placeholder="å¯é€‰ï¼Œå¦‚æœéœ€è¦çš„è¯"
                                       value="${link.password || ''}"
                                       onchange="updateDownloadLink('${link.id}', 'password', this.value)">
                            </div>
                        </div>

                        <div class="mt-3">
                            <label class="form-label text-sm">æ˜¾ç¤ºæ ‡ç­¾</label>
                            <input type="text" class="form-input text-sm" placeholder="å¦‚ï¼šç™¾åº¦ç½‘ç›˜ä¸‹è½½"
                                   value="${link.label || ''}"
                                   onchange="updateDownloadLink('${link.id}', 'label', this.value)">
                        </div>

                        <div class="mt-2 text-xs text-gray-500 flex items-center justify-between">
                            <span>é“¾æ¥ #${index + 1} - ${service ? service.icon + ' ' + service.name : 'æœªçŸ¥æœåŠ¡'}</span>
                            <span class="${link.url ? 'text-green-600' : 'text-red-600'}">${link.url ? 'âœ“ å·²é…ç½®' : 'âœ— éœ€è¦URL'}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function loadDownloadLinksFromGame(game) {
            // åŠ è½½æ¸¸æˆçš„ä¸‹è½½é“¾æ¥æ•°æ®ï¼Œæ”¯æŒå‘åå…¼å®¹
            currentDownloadLinks = [];
            
            if (game.download_links && Array.isArray(game.download_links)) {
                currentDownloadLinks = [...game.download_links];
            } else if (game.download_link && game.download_link !== '#') {
                // å¦‚æœåªæœ‰è€çš„download_linkï¼Œè‡ªåŠ¨è½¬æ¢
                currentDownloadLinks = [{
                    id: 'migrated_' + Date.now(),
                    service: 'other',
                    url: game.download_link,
                    password: '',
                    label: 'ä¸‹è½½é“¾æ¥'
                }];
            }
            
            renderDownloadLinks();
        }

        function getDownloadLinksForSave() {
            // éªŒè¯å¹¶è¿”å›ä¸‹è½½é“¾æ¥æ•°æ®
            const validLinks = currentDownloadLinks.filter(link => {
                return link.url && link.url.trim() && link.url !== '#';
            });
            
            return validLinks.map(link => ({
                id: link.id,
                service: link.service || 'other',
                url: link.url.trim(),
                password: link.password || '',
                label: link.label || 'ä¸‹è½½é“¾æ¥'
            }));
        }

        function previewDownloadLinks() {
            const validLinks = getDownloadLinksForSave();
            
            if (validLinks.length === 0) {
                showToast('è¯·å…ˆæ·»åŠ è‡³å°‘ä¸€ä¸ªä¸‹è½½é“¾æ¥', 'error');
                return;
            }

            // æ¨¡æ‹Ÿå‰ç«¯å±•ç¤ºçš„æ•ˆæœ
            const previewHtml = `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" onclick="this.remove()">
                    <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4" onclick="event.stopPropagation()">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold">ä¸‹è½½é“¾æ¥é¢„è§ˆ</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700 text-xl">&times;</button>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">è¿™æ˜¯ç”¨æˆ·åœ¨å‰ç«¯çœ‹åˆ°çš„ä¸‹è½½é“¾æ¥æ•ˆæœï¼š</p>
                        <div class="space-y-2">
                            ${validLinks.map(link => {
                                const service = CLOUD_SERVICES.find(s => s.id === link.service);
                                return `
                                    <button class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 px-4 rounded-lg flex items-center justify-center space-x-2 transition-colors">
                                        <span>${service ? service.icon : 'ğŸ”—'}</span>
                                        <span>${link.label}</span>
                                        ${link.password ? '<span class="text-xs opacity-75">(éœ€æå–ç )</span>' : ''}
                                    </button>
                                `;
                            }).join('')}
                        </div>
                        <div class="mt-4 p-3 bg-gray-100 rounded text-sm text-gray-600">
                            <p><strong>è¯´æ˜ï¼š</strong></p>
                            <ul class="list-disc list-inside space-y-1">
                                <li>ç”¨æˆ·ç‚¹å‡»æŒ‰é’®ä¼šæ˜¾ç¤ºäºŒç»´ç æ¨¡æ€æ¡†</li>
                                <li>äºŒç»´ç åŒ…å«ä¸‹è½½é“¾æ¥å’Œæå–ç ä¿¡æ¯</li>
                                <li>æ”¯æŒå¤åˆ¶é“¾æ¥å’Œæå–ç åŠŸèƒ½</li>
                            </ul>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', previewHtml);
        }

        // æ˜¾ç¤ºæ¨¡æ€æ¡†
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('show');
            
            // å¦‚æœæ˜¯æ¸¸æˆæ¨¡æ€æ¡†ä¸”æ²¡æœ‰ç°æœ‰çš„ä¸‹è½½é“¾æ¥ï¼Œåˆå§‹åŒ–ä¸€ä¸ªç©ºåˆ—è¡¨
            if (modalId === 'gameModal' && currentDownloadLinks.length === 0) {
                renderDownloadLinks();
            }
        }

        // éšè—æ¨¡æ€æ¡†
        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            
            // æ¸…ç©ºè¡¨å•
            if (modalId === 'gameModal') {
                document.getElementById('gameForm').reset();
                document.getElementById('gameId').value = '';
                updateImagePreview('');
                
                // é‡ç½®ä¸Šä¼ çŠ¶æ€
                document.getElementById('uploadBtn').disabled = true;
                document.getElementById('uploadStatus').textContent = '';
                
                // æ¸…ç©ºä¸‹è½½é“¾æ¥
                currentDownloadLinks = [];
                renderDownloadLinks();
            }
        }

        // åˆ‡æ¢åˆ†ç±»æ˜¾ç¤º
        function toggleCategory(categoryId) {
            const content = document.getElementById(`category-${categoryId}`);
            const arrow = content.previousElementSibling.querySelector('.category-arrow');
            
            if (content.classList.contains('open')) {
                content.classList.remove('open');
                arrow.textContent = 'â–¼';
            } else {
                content.classList.add('open');
                arrow.textContent = 'â–²';
            }
        }

        // ç¼–è¾‘æ¸¸æˆ
        function editGame(gameId) {
            const game = gamesData.find(g => g.id === gameId);
            if (!game) return;

            // å¡«å……è¡¨å•
            document.getElementById('gameId').value = game.id;
            document.getElementById('gameTitle').value = game.title;
            document.getElementById('gameCategory').value = game.category;
            document.getElementById('gameDescription').value = game.description || '';
            document.getElementById('gameCoverImage').value = game.cover_image || '';
            document.getElementById('gameStatus').value = game.status || 'draft';
            document.getElementById('gameTags').value = Array.isArray(game.tags) ? game.tags.join(', ') : '';
            document.getElementById('gameViewCount').value = game.view_count || 0;
            document.getElementById('gameDownloadCount').value = game.download_count || 0;
            
            // æ›´æ–°å›¾ç‰‡é¢„è§ˆ
            updateImagePreview(game.cover_image);
            
            // åŠ è½½ä¸‹è½½é“¾æ¥
            loadDownloadLinksFromGame(game);
            
            showModal('gameModal');
        }

        // ä¿å­˜æ¸¸æˆ
        async function saveGame(event) {
            event.preventDefault();
            
            const gameId = document.getElementById('gameId').value;
            const downloadLinks = getDownloadLinksForSave();
            
            const gameData = {
                title: document.getElementById('gameTitle').value,
                category: document.getElementById('gameCategory').value,
                description: document.getElementById('gameDescription').value,
                cover_image: document.getElementById('gameCoverImage').value || '/placeholder.svg',
                download_link: downloadLinks.length > 0 ? downloadLinks[0].url : '#', // å‘åå…¼å®¹
                download_links: downloadLinks,
                status: document.getElementById('gameStatus').value,
                tags: document.getElementById('gameTags').value.split(',').map(tag => tag.trim()).filter(tag => tag),
                view_count: parseInt(document.getElementById('gameViewCount').value) || 0,
                download_count: parseInt(document.getElementById('gameDownloadCount').value) || 0,
                content: document.getElementById('gameDescription').value
            };

            try {
                let response;
                if (gameId) {
                    // æ›´æ–°ç°æœ‰æ¸¸æˆ
                    response = await fetch(`/api/games/${gameId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(gameData)
                    });
                } else {
                    // åˆ›å»ºæ–°æ¸¸æˆ
                    response = await fetch('/api/games', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(gameData)
                    });
                }

                const result = await response.json();
                if (result.success) {
                    hideModal('gameModal');
                    loadGamesData();
                    loadSystemStatus();
                    showToast(gameId ? 'æ¸¸æˆæ›´æ–°æˆåŠŸï¼' : 'æ¸¸æˆåˆ›å»ºæˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('ä¿å­˜æ¸¸æˆå¤±è´¥:', error);
                showToast('ä¿å­˜å¤±è´¥: ' + error.message, 'error');
            }
        }

        // å‘å¸ƒæ¸¸æˆ
        async function publishGame(gameId) {
            if (!confirm('ç¡®å®šè¦å‘å¸ƒè¿™ä¸ªæ¸¸æˆå—ï¼Ÿ')) return;

            try {
                const response = await fetch(`/api/games/${gameId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        status: 'published',
                        published_at: new Date().toISOString().split('T')[0]
                    })
                });

                const result = await response.json();
                if (result.success) {
                    loadGamesData();
                    loadSystemStatus();
                    showToast('æ¸¸æˆå‘å¸ƒæˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('å‘å¸ƒæ¸¸æˆå¤±è´¥:', error);
                showToast('å‘å¸ƒå¤±è´¥: ' + error.message, 'error');
            }
        }

        // AIä¼˜åŒ–æ¸¸æˆå†…å®¹
        async function enhanceWithAI(gameId) {
            const game = gamesData.find(g => g.id === gameId);
            if (!game) return;

            if (!confirm(`ç¡®å®šè¦ä½¿ç”¨AIä¼˜åŒ–"${game.title}"çš„å†…å®¹å—ï¼Ÿ`)) return;

            try {
                showToast('æ­£åœ¨ä½¿ç”¨AIä¼˜åŒ–æ¸¸æˆå†…å®¹...', 'info');
                
                const response = await fetch('/api/ai/enhance-game', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        gameId: gameId,
                        title: game.title,
                        category: game.category,
                        currentDescription: game.description
                    })
                });

                const result = await response.json();
                if (result.success) {
                    showToast('AIä¼˜åŒ–å®Œæˆï¼', 'success');
                    loadGamesData(); // é‡æ–°åŠ è½½æ•°æ®ä»¥æ˜¾ç¤ºä¼˜åŒ–åçš„å†…å®¹
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('AIä¼˜åŒ–å¤±è´¥:', error);
                showToast('AIä¼˜åŒ–å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ’¤å›æ¸¸æˆ
        async function unpublishGame(gameId) {
            if (!confirm('ç¡®å®šè¦æ’¤å›è¿™ä¸ªæ¸¸æˆå—ï¼Ÿ')) return;

            try {
                const response = await fetch(`/api/games/${gameId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        status: 'draft',
                        published_at: null
                    })
                });

                const result = await response.json();
                if (result.success) {
                    loadGamesData();
                    loadSystemStatus();
                    showToast('æ¸¸æˆå·²æ’¤å›åˆ°è‰ç¨¿ç®±ï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('æ’¤å›æ¸¸æˆå¤±è´¥:', error);
                showToast('æ’¤å›å¤±è´¥: ' + error.message, 'error');
            }
        }

        // åˆ é™¤æ¸¸æˆ
        async function deleteGame(gameId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ¸¸æˆå—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) return;

            try {
                const response = await fetch(`/api/data/games/${gameId}`, {
                    method: 'DELETE'
                });

                const result = await response.json();
                if (result.success) {
                    loadGamesData();
                    loadSystemStatus();
                    showToast('åˆ é™¤æˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('åˆ é™¤æ¸¸æˆå¤±è´¥:', error);
                showToast('åˆ é™¤å¤±è´¥: ' + error.message, 'error');
            }
        }

        // ç½‘ç«™å†…å®¹ç®¡ç†
        async function loadWebsiteContent() {
            try {
                const response = await fetch('/api/data/website-content');
                const result = await response.json();
                
                if (result.success) {
                    websiteContent = result.data || {};
                    populateContentFields();
                }
            } catch (error) {
                console.error('åŠ è½½ç½‘ç«™å†…å®¹å¤±è´¥:', error);
            }
        }

        function populateContentFields() {
            // å…³äºæˆ‘ä»¬
            if (websiteContent.about) {
                document.getElementById('aboutTitle').value = websiteContent.about.title || 'å…³äºæˆ‘ä»¬';
                document.getElementById('aboutContent').value = websiteContent.about.content || '';
            }

            // é¦–é¡µè‹±é›„åŒºåŸŸ
            if (websiteContent.homepage?.hero) {
                const hero = websiteContent.homepage.hero;
                document.getElementById('heroTitle').value = hero.title || '';
                document.getElementById('heroSubtitle').value = hero.subtitle || '';
                document.getElementById('heroDescription').value = hero.description || '';
                document.getElementById('heroCtaText').value = hero.cta_text || '';
            }

            // åº•éƒ¨ä¿¡æ¯
            if (websiteContent.footer) {
                document.getElementById('footerCopyright').value = websiteContent.footer.copyright || '';
                const githubLink = websiteContent.footer.social?.find(s => s.platform === 'GitHub');
                document.getElementById('githubUrl').value = githubLink?.url || '';
            }

            // SEOè®¾ç½®
            if (websiteContent.seo) {
                document.getElementById('metaTitle').value = websiteContent.seo.meta_title || '';
                document.getElementById('metaDescription').value = websiteContent.seo.meta_description || '';
                document.getElementById('metaKeywords').value = websiteContent.seo.meta_keywords || '';
            }
        }

        async function saveContent(section) {
            let updatedContent = { ...websiteContent };
            
            try {
                switch(section) {
                    case 'about':
                        updatedContent.about = {
                            title: document.getElementById('aboutTitle').value,
                            content: document.getElementById('aboutContent').value,
                            updated_at: new Date().toISOString()
                        };
                        break;
                    
                    case 'homepage':
                        if (!updatedContent.homepage) updatedContent.homepage = {};
                        updatedContent.homepage.hero = {
                            title: document.getElementById('heroTitle').value,
                            subtitle: document.getElementById('heroSubtitle').value,
                            description: document.getElementById('heroDescription').value,
                            cta_text: document.getElementById('heroCtaText').value,
                            background_image: websiteContent.homepage?.hero?.background_image || "/hero-bg.jpg"
                        };
                        updatedContent.homepage.updated_at = new Date().toISOString();
                        break;
                    
                    case 'footer':
                        const githubUrl = document.getElementById('githubUrl').value;
                        updatedContent.footer = {
                            copyright: document.getElementById('footerCopyright').value,
                            links: websiteContent.footer?.links || [],
                            social: [
                                {platform: "GitHub", url: githubUrl, icon: "github"},
                                ...(websiteContent.footer?.social?.filter(s => s.platform !== 'GitHub') || [])
                            ],
                            updated_at: new Date().toISOString()
                        };
                        break;
                    
                    case 'seo':
                        updatedContent.seo = {
                            meta_title: document.getElementById('metaTitle').value,
                            meta_description: document.getElementById('metaDescription').value,
                            meta_keywords: document.getElementById('metaKeywords').value,
                            og_image: websiteContent.seo?.og_image || "/og-image.jpg",
                            updated_at: new Date().toISOString()
                        };
                        break;
                }

                const response = await fetch('/api/data/website-content', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ data: updatedContent })
                });

                const result = await response.json();
                if (result.success) {
                    websiteContent = updatedContent;
                    showToast(`${getSectionName(section)}ä¿å­˜æˆåŠŸï¼`, 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('ä¿å­˜ç½‘ç«™å†…å®¹å¤±è´¥:', error);
                showToast('ä¿å­˜å¤±è´¥: ' + error.message, 'error');
            }
        }

        function getSectionName(section) {
            const names = {
                'about': 'å…³äºæˆ‘ä»¬',
                'homepage': 'é¦–é¡µå†…å®¹',
                'footer': 'åº•éƒ¨ä¿¡æ¯',
                'seo': 'SEOè®¾ç½®'
            };
            return names[section] || 'å†…å®¹';
        }

        // è®¾ç½®ç®¡ç†
        async function saveSettings() {
            showToast('è®¾ç½®ä¿å­˜åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // å‰ç«¯å¯¼èˆªåŠŸèƒ½
        function navigateToFrontend(gameId) {
            // æ„å»ºå‰ç«¯æ¸¸æˆè¯¦æƒ…é¡µURL
            let frontendBaseUrl = window.location.origin;
            
            // å¦‚æœå½“å‰æ˜¯ç®¡ç†åå°ç«¯å£3008ï¼Œå°è¯•è®¿é—®å¸¸è§çš„å‰ç«¯ç«¯å£
            if (window.location.port === '3008') {
                // å°è¯•å¸¸è§çš„å‰ç«¯å¼€å‘ç«¯å£
                const frontendPorts = ['8083', '5173', '3000', '8080', '8081', '8082'];
                const protocol = window.location.protocol;
                const hostname = window.location.hostname;
                
                // é»˜è®¤ä½¿ç”¨å½“å‰æ£€æµ‹åˆ°çš„å‰ç«¯ç«¯å£8083
                frontendBaseUrl = `${protocol}//${hostname}:8083`;
            }
            
            const gameUrl = `${frontendBaseUrl}/#/game/${gameId}`;
            
            // åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€
            window.open(gameUrl, '_blank');
            
            showToast('å·²æ‰“å¼€å‰ç«¯æ¸¸æˆé¡µé¢: ' + gameUrl, 'success');
        }

        // å·¥å…·å‡½æ•°
        function refreshData() {
            loadConfig();
            loadSystemStatus();
            loadAllData();
            showToast('æ•°æ®å·²åˆ·æ–°', 'success');
        }

        function backupData() {
            showToast('æ•°æ®å¤‡ä»½åŠŸèƒ½å¼€å‘ä¸­...', 'info');
        }

        // å¼¹çª—æ•°æ®ç®¡ç†
        async function loadPopupsData() {
            try {
                const response = await fetch('/api/data/popups');
                const result = await response.json();
                
                if (result.success) {
                    popupsData = result.data || [];
                    renderPopupsGrid();
                }
            } catch (error) {
                console.error('åŠ è½½å¼¹çª—æ•°æ®å¤±è´¥:', error);
                renderPopupsGrid([]);
            }
        }

        function renderPopupsGrid() {
            const grid = document.getElementById('popupsGrid');
            if (!popupsData || popupsData.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-8 text-gray-500">æš‚æ— å¼¹çª—é…ç½®</div>';
                return;
            }

            grid.innerHTML = popupsData.map(popup => `
                <div class="bg-white rounded-lg shadow-md p-6 border-l-4 ${popup.enabled ? 'border-green-400' : 'border-gray-400'}">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="font-bold text-lg">${popup.title}</h3>
                        <span class="px-2 py-1 rounded text-xs font-bold ${popup.enabled ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'}">
                            ${popup.enabled ? 'å¯ç”¨' : 'ç¦ç”¨'}
                        </span>
                    </div>
                    <p class="text-gray-600 text-sm mb-3">${popup.content || 'æš‚æ— å†…å®¹'}</p>
                    <div class="text-xs text-gray-500 mb-4">
                        <div>ç±»å‹: ${getPopupTypeName(popup.type)}</div>
                        <div>ä½ç½®: ${getPopupPositionName(popup.position)}</div>
                        <div>é¢‘ç‡: ${getPopupFrequencyName(popup.frequency)}</div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editPopup('${popup.id}')" class="blue-button text-white px-3 py-1 rounded text-sm">
                            âœï¸ ç¼–è¾‘
                        </button>
                        <button onclick="togglePopup('${popup.id}', ${!popup.enabled})" class="yellow-button text-white px-3 py-1 rounded text-sm">
                            ${popup.enabled ? 'ç¦ç”¨' : 'å¯ç”¨'}
                        </button>
                        <button onclick="deletePopup('${popup.id}')" class="mario-button text-white px-3 py-1 rounded text-sm">
                            ğŸ—‘ï¸ åˆ é™¤
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // æ‚¬æµ®å…ƒç´ æ•°æ®ç®¡ç†
        async function loadFloatingElementsData() {
            try {
                const response = await fetch('/api/data/floating-windows');
                const result = await response.json();
                
                if (result.success) {
                    floatingElementsData = result.data || [];
                    renderFloatingElementsGrid();
                }
            } catch (error) {
                console.error('åŠ è½½æ‚¬æµ®å…ƒç´ æ•°æ®å¤±è´¥:', error);
                renderFloatingElementsGrid([]);
            }
        }

        function renderFloatingElementsGrid() {
            const grid = document.getElementById('floatingElementsGrid');
            if (!floatingElementsData || floatingElementsData.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center py-8 text-gray-500">æš‚æ— æ‚¬æµ®å…ƒç´ é…ç½®</div>';
                return;
            }

            grid.innerHTML = floatingElementsData.map(element => `
                <div class="bg-white rounded-lg shadow-md p-4 border-l-4 ${element.enabled ? 'border-blue-400' : 'border-gray-400'}">
                    <div class="flex justify-between items-start mb-3">
                        <div class="flex items-center">
                            <span class="text-lg mr-2">${element.icon || 'ğŸ“±'}</span>
                            <h3 class="font-bold">${element.title}</h3>
                        </div>
                        <span class="px-2 py-1 rounded text-xs font-bold ${element.enabled ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-800'}">
                            ${element.enabled ? 'å¯ç”¨' : 'ç¦ç”¨'}
                        </span>
                    </div>
                    <div class="text-xs text-gray-500 mb-3">
                        <div>ç±»å‹: ${getFloatingTypeName(element.type)}</div>
                        <div>ä½ç½®: ${getFloatingPositionName(element.position)}</div>
                        <div>è¡Œä¸º: ${getFloatingActionName(element.action)}</div>
                    </div>
                    <div class="flex space-x-2">
                        <button onclick="editFloatingElement('${element.id}')" class="blue-button text-white px-2 py-1 rounded text-xs">
                            âœï¸ ç¼–è¾‘
                        </button>
                        <button onclick="toggleFloatingElement('${element.id}', ${!element.enabled})" class="yellow-button text-white px-2 py-1 rounded text-xs">
                            ${element.enabled ? 'ç¦ç”¨' : 'å¯ç”¨'}
                        </button>
                        <button onclick="deleteFloatingElement('${element.id}')" class="mario-button text-white px-2 py-1 rounded text-xs">
                            ğŸ—‘ï¸ åˆ é™¤
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // è¡¨å•åˆå§‹åŒ–
        function initPopupForm() {
            document.getElementById('popupForm').addEventListener('submit', savePopup);
        }

        function initFloatingForm() {
            document.getElementById('floatingForm').addEventListener('submit', saveFloatingElement);
        }

        // å¼¹çª—ç®¡ç†åŠŸèƒ½
        function editPopup(popupId) {
            const popup = popupsData.find(p => p.id === popupId);
            if (!popup) return;

            // å¡«å……è¡¨å•
            document.getElementById('popupId').value = popup.id;
            document.getElementById('popupTitle').value = popup.title;
            document.getElementById('popupType').value = popup.type || 'welcome';
            document.getElementById('popupPosition').value = popup.position || 'center';
            document.getElementById('popupContent').value = popup.content || '';
            document.getElementById('popupImage').value = popup.image || '';
            document.getElementById('popupButtonText').value = popup.button_text || '';
            document.getElementById('popupButtonUrl').value = popup.button_url || '';
            document.getElementById('popupDelay').value = popup.delay || 2;
            document.getElementById('popupAutoClose').value = popup.auto_close || 0;
            document.getElementById('popupFrequency').value = popup.frequency || 'daily';
            document.getElementById('popupStartDate').value = popup.start_date || '';
            document.getElementById('popupEndDate').value = popup.end_date || '';
            document.getElementById('popupEnabled').checked = popup.enabled || false;
            
            showModal('popupModal');
        }

        async function savePopup(event) {
            event.preventDefault();
            
            const popupId = document.getElementById('popupId').value;
            const popupData = {
                title: document.getElementById('popupTitle').value,
                type: document.getElementById('popupType').value,
                position: document.getElementById('popupPosition').value,
                content: document.getElementById('popupContent').value,
                image: document.getElementById('popupImage').value,
                button_text: document.getElementById('popupButtonText').value,
                button_url: document.getElementById('popupButtonUrl').value,
                delay: parseInt(document.getElementById('popupDelay').value) || 2,
                auto_close: parseInt(document.getElementById('popupAutoClose').value) || 0,
                frequency: document.getElementById('popupFrequency').value,
                start_date: document.getElementById('popupStartDate').value,
                end_date: document.getElementById('popupEndDate').value,
                enabled: document.getElementById('popupEnabled').checked,
                updated_at: new Date().toISOString()
            };

            try {
                if (popupId) {
                    // æ›´æ–°ç°æœ‰å¼¹çª—
                    const index = popupsData.findIndex(p => p.id === popupId);
                    if (index !== -1) {
                        popupsData[index] = { ...popupsData[index], ...popupData };
                    }
                } else {
                    // åˆ›å»ºæ–°å¼¹çª—
                    popupData.id = 'popup_' + Date.now();
                    popupData.created_at = new Date().toISOString();
                    popupsData.push(popupData);
                }

                // ä¿å­˜åˆ°æœåŠ¡å™¨
                const response = await fetch('/api/data/popups', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: popupsData })
                });

                const result = await response.json();
                if (result.success) {
                    hideModal('popupModal');
                    renderPopupsGrid();
                    showToast(popupId ? 'å¼¹çª—æ›´æ–°æˆåŠŸï¼' : 'å¼¹çª—åˆ›å»ºæˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('ä¿å­˜å¼¹çª—å¤±è´¥:', error);
                showToast('ä¿å­˜å¤±è´¥: ' + error.message, 'error');
            }
        }

        // æ‚¬æµ®å…ƒç´ ç®¡ç†åŠŸèƒ½
        function editFloatingElement(elementId) {
            const element = floatingElementsData.find(e => e.id === elementId);
            if (!element) return;

            // å¡«å……è¡¨å•
            document.getElementById('floatingId').value = element.id;
            document.getElementById('floatingTitle').value = element.title;
            document.getElementById('floatingType').value = element.type || 'custom';
            document.getElementById('floatingPosition').value = element.position || 'bottom-right';
            document.getElementById('floatingIcon').value = element.icon || '';
            document.getElementById('floatingBgColor').value = element.bg_color || '#007bff';
            document.getElementById('floatingAction').value = element.action || 'link';
            document.getElementById('floatingContent').value = element.content || '';
            document.getElementById('floatingQRCode').value = element.qr_code || '';
            document.getElementById('floatingSize').value = element.size || 'medium';
            document.getElementById('floatingZIndex').value = element.z_index || 1000;
            document.getElementById('floatingEnabled').checked = element.enabled || false;
            
            showModal('floatingModal');
        }

        async function saveFloatingElement(event) {
            event.preventDefault();
            
            const elementId = document.getElementById('floatingId').value;
            const elementData = {
                title: document.getElementById('floatingTitle').value,
                type: document.getElementById('floatingType').value,
                position: document.getElementById('floatingPosition').value,
                icon: document.getElementById('floatingIcon').value,
                bg_color: document.getElementById('floatingBgColor').value,
                action: document.getElementById('floatingAction').value,
                content: document.getElementById('floatingContent').value,
                qr_code: document.getElementById('floatingQRCode').value,
                size: document.getElementById('floatingSize').value,
                z_index: parseInt(document.getElementById('floatingZIndex').value) || 1000,
                enabled: document.getElementById('floatingEnabled').checked,
                updated_at: new Date().toISOString()
            };

            try {
                if (elementId) {
                    // æ›´æ–°ç°æœ‰å…ƒç´ 
                    const index = floatingElementsData.findIndex(e => e.id === elementId);
                    if (index !== -1) {
                        floatingElementsData[index] = { ...floatingElementsData[index], ...elementData };
                    }
                } else {
                    // åˆ›å»ºæ–°å…ƒç´ 
                    elementData.id = 'floating_' + Date.now();
                    elementData.created_at = new Date().toISOString();
                    floatingElementsData.push(elementData);
                }

                // ä¿å­˜åˆ°æœåŠ¡å™¨
                const response = await fetch('/api/data/floating-windows', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: floatingElementsData })
                });

                const result = await response.json();
                if (result.success) {
                    hideModal('floatingModal');
                    renderFloatingElementsGrid();
                    showToast(elementId ? 'æ‚¬æµ®å…ƒç´ æ›´æ–°æˆåŠŸï¼' : 'æ‚¬æµ®å…ƒç´ åˆ›å»ºæˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('ä¿å­˜æ‚¬æµ®å…ƒç´ å¤±è´¥:', error);
                showToast('ä¿å­˜å¤±è´¥: ' + error.message, 'error');
            }
        }

        // è¾…åŠ©å‡½æ•°
        function getPopupTypeName(type) {
            const types = {
                'welcome': 'æ¬¢è¿å¼¹çª—',
                'announcement': 'å…¬å‘Šå¼¹çª—',
                'promotion': 'æ¨å¹¿å¼¹çª—',
                'notification': 'é€šçŸ¥å¼¹çª—'
            };
            return types[type] || 'æœªçŸ¥ç±»å‹';
        }

        function getPopupPositionName(position) {
            const positions = {
                'center': 'å±…ä¸­æ˜¾ç¤º',
                'top': 'é¡¶éƒ¨æ˜¾ç¤º',
                'bottom': 'åº•éƒ¨æ˜¾ç¤º'
            };
            return positions[position] || 'æœªçŸ¥ä½ç½®';
        }

        function getPopupFrequencyName(frequency) {
            const frequencies = {
                'once': 'ä»…ä¸€æ¬¡',
                'daily': 'æ¯å¤©ä¸€æ¬¡',
                'session': 'æ¯æ¬¡ä¼šè¯',
                'always': 'æ¯æ¬¡è®¿é—®'
            };
            return frequencies[frequency] || 'æœªçŸ¥é¢‘ç‡';
        }

        function getFloatingTypeName(type) {
            const types = {
                'qrcode': 'äºŒç»´ç ',
                'social': 'ç¤¾äº¤é“¾æ¥',
                'contact': 'è”ç³»æ–¹å¼',
                'download': 'ä¸‹è½½é“¾æ¥',
                'custom': 'è‡ªå®šä¹‰'
            };
            return types[type] || 'æœªçŸ¥ç±»å‹';
        }

        function getFloatingPositionName(position) {
            const positions = {
                'bottom-right': 'å³ä¸‹è§’',
                'bottom-left': 'å·¦ä¸‹è§’',
                'top-right': 'å³ä¸Šè§’',
                'top-left': 'å·¦ä¸Šè§’',
                'center-right': 'å³ä¾§å±…ä¸­',
                'center-left': 'å·¦ä¾§å±…ä¸­'
            };
            return positions[position] || 'æœªçŸ¥ä½ç½®';
        }

        function getFloatingActionName(action) {
            const actions = {
                'link': 'æ‰“å¼€é“¾æ¥',
                'popup': 'æ˜¾ç¤ºå¼¹çª—',
                'download': 'ä¸‹è½½æ–‡ä»¶',
                'copy': 'å¤åˆ¶æ–‡æœ¬'
            };
            return actions[action] || 'æœªçŸ¥è¡Œä¸º';
        }

        // åˆ é™¤å’Œåˆ‡æ¢çŠ¶æ€å‡½æ•°
        async function deletePopup(popupId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå¼¹çª—é…ç½®å—ï¼Ÿ')) return;

            try {
                popupsData = popupsData.filter(p => p.id !== popupId);
                
                const response = await fetch('/api/data/popups', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: popupsData })
                });

                const result = await response.json();
                if (result.success) {
                    renderPopupsGrid();
                    showToast('å¼¹çª—åˆ é™¤æˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('åˆ é™¤å¼¹çª—å¤±è´¥:', error);
                showToast('åˆ é™¤å¤±è´¥: ' + error.message, 'error');
            }
        }

        async function deleteFloatingElement(elementId) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªæ‚¬æµ®å…ƒç´ å—ï¼Ÿ')) return;

            try {
                floatingElementsData = floatingElementsData.filter(e => e.id !== elementId);
                
                const response = await fetch('/api/data/floating-windows', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: floatingElementsData })
                });

                const result = await response.json();
                if (result.success) {
                    renderFloatingElementsGrid();
                    showToast('æ‚¬æµ®å…ƒç´ åˆ é™¤æˆåŠŸï¼', 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('åˆ é™¤æ‚¬æµ®å…ƒç´ å¤±è´¥:', error);
                showToast('åˆ é™¤å¤±è´¥: ' + error.message, 'error');
            }
        }

        async function togglePopup(popupId, enabled) {
            try {
                const index = popupsData.findIndex(p => p.id === popupId);
                if (index !== -1) {
                    popupsData[index].enabled = enabled;
                    popupsData[index].updated_at = new Date().toISOString();
                }

                const response = await fetch('/api/data/popups', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: popupsData })
                });

                const result = await response.json();
                if (result.success) {
                    renderPopupsGrid();
                    showToast(`å¼¹çª—å·²${enabled ? 'å¯ç”¨' : 'ç¦ç”¨'}ï¼`, 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('åˆ‡æ¢å¼¹çª—çŠ¶æ€å¤±è´¥:', error);
                showToast('æ“ä½œå¤±è´¥: ' + error.message, 'error');
            }
        }

        async function toggleFloatingElement(elementId, enabled) {
            try {
                const index = floatingElementsData.findIndex(e => e.id === elementId);
                if (index !== -1) {
                    floatingElementsData[index].enabled = enabled;
                    floatingElementsData[index].updated_at = new Date().toISOString();
                }

                const response = await fetch('/api/data/floating-windows', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ data: floatingElementsData })
                });

                const result = await response.json();
                if (result.success) {
                    renderFloatingElementsGrid();
                    showToast(`æ‚¬æµ®å…ƒç´ å·²${enabled ? 'å¯ç”¨' : 'ç¦ç”¨'}ï¼`, 'success');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                console.error('åˆ‡æ¢æ‚¬æµ®å…ƒç´ çŠ¶æ€å¤±è´¥:', error);
                showToast('æ“ä½œå¤±è´¥: ' + error.message, 'error');
            }
        }

        // åŠ è½½å‘å¸ƒçŠ¶æ€
        async function loadPublishStatus() {
            try {
                const response = await fetch('/api/publish-status');
                const result = await response.json();
                
                if (result.success) {
                    const data = result.data;
                    const publishStatus = document.getElementById('publishStatus');
                    const lastPublish = document.getElementById('lastPublish');
                    
                    if (data.hasUncommittedChanges) {
                        publishStatus.textContent = 'æœ‰æ›´æ”¹å¾…å‘å¸ƒ';
                        publishStatus.className = 'text-yellow-600 font-bold';
                    } else {
                        publishStatus.textContent = 'å·²å‘å¸ƒ';
                        publishStatus.className = 'text-green-600 font-bold';
                    }
                    
                    lastPublish.textContent = data.lastCommit.date;
                }
            } catch (error) {
                console.error('åŠ è½½å‘å¸ƒçŠ¶æ€å¤±è´¥:', error);
            }
        }

        // å‘å¸ƒåˆ°ç½‘ç«™åŠŸèƒ½
        async function publishToWebsite() {
            const publishButton = document.getElementById('publishButton');
            const publishStatus = document.getElementById('publishStatus');
            const deploymentStatus = document.getElementById('deploymentStatus');
            const deploymentText = document.getElementById('deploymentText');
            const deploymentIndicator = document.getElementById('deploymentIndicator');
            
            try {
                // æ›´æ–°UIçŠ¶æ€
                publishButton.disabled = true;
                publishButton.innerHTML = 'ğŸ”„ å‘å¸ƒä¸­...';
                publishStatus.textContent = 'æ­£åœ¨å‘å¸ƒ...';
                publishStatus.className = 'text-yellow-600 font-bold';
                
                deploymentStatus.classList.remove('hidden');
                deploymentIndicator.className = 'w-2 h-2 rounded-full bg-yellow-500 inline-block mr-2 animate-pulse';
                deploymentText.textContent = 'æ­£åœ¨å‘å¸ƒ...';
                
                // è°ƒç”¨æœåŠ¡ç«¯å‘å¸ƒAPI
                const response = await fetch('/api/publish-website', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: 'Auto-publish from admin panel: Update games and content'
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // å‘å¸ƒæˆåŠŸ
                    publishStatus.textContent = 'å‘å¸ƒæˆåŠŸ';
                    publishStatus.className = 'text-green-600 font-bold';
                    deploymentIndicator.className = 'w-2 h-2 rounded-full bg-green-500 inline-block mr-2';
                    deploymentText.textContent = 'å‘å¸ƒæˆåŠŸ';
                    
                    const now = new Date();
                    document.getElementById('lastPublish').textContent = now.toLocaleString('zh-CN');
                    
                    showToast('ç½‘ç«™å†…å®¹å·²å‘å¸ƒåˆ°GitHub Pagesï¼', 'success');
                    
                    // é‡æ–°åŠ è½½å‘å¸ƒçŠ¶æ€
                    setTimeout(() => {
                        loadPublishStatus();
                    }, 2000);
                    
                    // 3ç§’åéšè—éƒ¨ç½²çŠ¶æ€
                    setTimeout(() => {
                        deploymentStatus.classList.add('hidden');
                    }, 5000);
                    
                } else {
                    throw new Error(result.error || 'å‘å¸ƒå¤±è´¥');
                }
                
            } catch (error) {
                console.error('å‘å¸ƒå¤±è´¥:', error);
                publishStatus.textContent = 'å‘å¸ƒå¤±è´¥';
                publishStatus.className = 'text-red-600 font-bold';
                deploymentIndicator.className = 'w-2 h-2 rounded-full bg-red-500 inline-block mr-2';
                deploymentText.textContent = 'å‘å¸ƒå¤±è´¥';
                
                showToast('å‘å¸ƒå¤±è´¥: ' + error.message, 'error');
                
            } finally {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                publishButton.disabled = false;
                publishButton.innerHTML = 'ğŸš€ å‘å¸ƒåˆ°GitHub Pages';
                
                // 5ç§’åæ¢å¤çŠ¶æ€
                setTimeout(() => {
                    publishStatus.textContent = 'å‡†å¤‡å°±ç»ª';
                    publishStatus.className = 'text-green-600 font-bold';
                }, 3000);
            }
        }

        function showToast(message, type = 'info') {
            // åˆ›å»ºtoastå…ƒç´ 
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg text-white font-bold z-50 ${
                type === 'success' ? 'bg-green-500' : 
                type === 'error' ? 'bg-red-500' : 
                'bg-blue-500'
            }`;
            toast.textContent = message;
            
            document.body.appendChild(toast);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤
            setTimeout(() => {
                if (document.body.contains(toast)) {
                    document.body.removeChild(toast);
                }
            }, 3000);
        }
    </script>
</body>
</html>